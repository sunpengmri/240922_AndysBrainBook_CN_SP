<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Machine Learning Tutorial #4: Creating the Timing Files &mdash; Andy&#39;s Brain Book 1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b76e3c8a" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=f2a433a1"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Machine Learning Tutorial #5: MVPA Analysis with The Decoding Toolbox" href="ML_05_Haxby_MVPA.html" />
    <link rel="prev" title="Machine Learning Tutorial #3: Preprocessing" href="ML_03_Haxby_Preprocessing.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Andy's Brain Book
          </a>
              <div class="version">
                1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Install</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../installation/fsl_mac_install.html">Overview</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Unix for Neuroimagers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_Intro.html">What is Unix?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_01_Navigation.html">Unix Tutorial #1: 目录操作 (Directories and Navigation)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_02_CopyRemove.html">Unix Tutorial #2: Copying and Removing Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_03_ReadingTextFiles.html">Unix Tutorial #3: Reading Text Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_04_ShellsVariables.html">Unix Tutorial #4: Shells and Path Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_05_ForLoops.html">Unix Tutorial #5: For-Loops</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_06_IfElse.html">Unix Tutorial #6: Conditional Statements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_07_Scripting.html">Unix Tutorial #7: Scripting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_08_Sed.html">Unix Tutorial #8: The Sed Command</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_09_AutomatingTheAnalysis.html">Unix Tutorial #9: Automating The Analysis</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">fMRI Short Course with FSL</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_Intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_01_DataDownload.html">fMRI Tutorial #1: Downloading the Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_02_ExperimentalDesign.html">fMRI Tutorial #2: Overview of The Flanker Task</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_03_LookingAtTheData.html">fMRI Tutorial #3: Looking at the Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_04_Preprocessing.html">fMRI Tutorial #4: Preprocessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_05_1stLevelAnalysis.html">fMRI Tutorial #5: Statistics and Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_06_Scripting.html">fMRI Tutorial #6: Scripting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_07_2ndLevelAnalysis.html">fMRI Tutorial #7: 2nd-Level Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_08_3rdLevelAnalysis.html">fMRI Tutorial #8: 3rd-Level Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_09_ROIAnalysis.html">fMRI Tutorial #9: ROI Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_10_Summary.html">fMRI Tutorial #10: Summary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_Appendices.html">fMRI Short Course: Appendices</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">FreeSurfer</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../FreeSurfer/FreeSurfer_Introduction.html">FreeSurfer Short Course</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">E-Prime</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../E-Prime/E-Prime_Overview.html">Overview of E-Prime</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">AFNI</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../AFNI/AFNI_Overview.html">AFNI Overview</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">SPM</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../SPM/SPM_Overview.html">SPM Overview</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Functional Connectivity with the CONN Toolbox</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../FunctionalConnectivity/CONN_Overview.html">Functional Connectivity and the CONN Toolbox</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Parametric Modulation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../PM/PM_Overview.html">Parametric Modulation in SPM, FSL, and AFNI</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Image Visualization with MRIcroGL</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../MRIcroGL/MRIcroGL_Overview.html">Image Visualization with MRIcroGL</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Introduction to the Human Connectome Project (HCP)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../HCP/HCP_Overview.html">Introduction to the Human Connectome Project</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Finite Impulse Response (FIR) Models</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../FIR/FIR_Overview.html">Finite Impulse Response (FIR)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">fMRI Concepts</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Practicals/DesignOptimization.html">Design Optimization</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Diffusion Analysis with MRtrix</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../MRtrix/MRtrix_Introduction.html">Introduction to MRtrix</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ASL Analysis</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../ASL/ASL_Techniques.html">fASL Tutorial #1: Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ASL/fASL_02_Download.html">fASL Tutorial #2: Downloading and Installing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ASL/fASL_03_Task.html">fASL Tutorial #3: The N-Back Task</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ASL/04_fASL_GUI.html">fASL Tutorial #4: The GUI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ASL/05_fASL_Results.html">fASL Tutorial #5: Examining the Results</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ASL/06_fASL_Quantification.html">fASL Tutorial #6: Quantification</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Frequently Asked Questions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../FrequentlyAskedQuestions/FrequentlyAskedQuestions.html">Frequently Asked Questions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Statistics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Statistics/GIMME.html">GIMME (Group Iterative Multiple Model Estimation)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Open Science</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../OpenScience/OS_Overview.html">Open Science</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced Normalization Tools (ANTs)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../ANTs/ANTs_Overview.html">Advanced Normalization Tools (ANTs)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tract-Based Spatial Statistics (TBSS)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../TBSS/TBSS_Overview.html">Introduction to Tract-Based Spatial Statistics (TBSS)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Statistics for Neuroimagers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Stats/Stats_Overview.html">Statistics for Neuroimagers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Machine Learning for Neuroimagers</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../ML_Overview.html">Machine Learning for Neuroimagers</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../ML_Overview.html#overview">Overview</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="ML_00_Introduction.html">Machine Learning: Introduction to Basic Terms and Concepts</a></li>
<li class="toctree-l3"><a class="reference internal" href="ML_01_Brown_Example.html">Machine Learning Tutorial #1: Basic Example with Support Vector Machines</a></li>
<li class="toctree-l3"><a class="reference internal" href="ML_02_Haxby_Intro_Download.html">Machine Learning Tutorial #2: The Haxby Dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="ML_03_Haxby_Preprocessing.html">Machine Learning Tutorial #3: Preprocessing</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Machine Learning Tutorial #4: Creating the Timing Files</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#modifying-the-script">Modifying the Script</a></li>
<li class="toctree-l4"><a class="reference internal" href="#video">Video</a></li>
<li class="toctree-l4"><a class="reference internal" href="#next-steps">Next Steps</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ML_05_Haxby_MVPA.html">Machine Learning Tutorial #5: MVPA Analysis with The Decoding Toolbox</a></li>
<li class="toctree-l3"><a class="reference internal" href="ML_06_Haxby_Scripting.html">Machine Learning Tutorial #6: Scripting</a></li>
<li class="toctree-l3"><a class="reference internal" href="ML_07_Haxby_GroupAnalysis.html">Machine Learning Tutorial #7: Group Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="ML_08_Haxby_NonParametric.html">Machine Learning Tutorial #8: Non-Parametric Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="ML_09_RSA.html">Machine Learning Tutorial #9: Representational Similarity Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="ML_10_Hyperalignment.html">Machine Learning Tutorial #10: Hyperalignment</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Slicer</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Slicer/Slicer_Overview.html">Slicer Overview</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">CAT12</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../CAT12/CAT12_Overview.html">Voxel-Based Morphometry with CAT12</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Using the Supercomputer</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Supercomputer/Supercomputer_Overview.html">Introduction to Supercomputing</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Matlab for Neuroimagers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Matlab/Matlab_Overview.html">Matlab for Neuroimagers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ITK-Snap</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../ITK-Snap/ITK-Snap_Overview.html">ITK-Snap_Overview</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Python for Neuroimagers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../PythonForNeuroimagers/PythonForNeuroimagers_Overview.html">Python for Neuroimagers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Meta-Analysis for fMRI</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../MetaAnalysis/MetaAnalysis_Overview.html">Meta-Analysis for Neuroimagers</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Andy's Brain Book</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../ML_Overview.html">Machine Learning for Neuroimagers</a></li>
      <li class="breadcrumb-item active">Machine Learning Tutorial #4: Creating the Timing Files</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/ML/ML_Short_Course/ML_04_Haxby_Timing.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="machine-learning-tutorial-4-creating-the-timing-files">
<span id="ml-04-haxby-timing"></span><h1>Machine Learning Tutorial #4: Creating the Timing Files<a class="headerlink" href="#machine-learning-tutorial-4-creating-the-timing-files" title="Link to this heading"></a></h1>
<hr class="docutils" />
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading"></a></h2>
<p>Once we have created a template, we will need to change the timings for each run. Each subject in the dataset has 12 timing files in their <code class="docutils literal notranslate"><span class="pre">func</span></code> folder, corresponding to each run of functional data. For example, the first few lines of the file <code class="docutils literal notranslate"><span class="pre">sub-1_task_objectviewing_run-01_events.tsv</span></code> in the folder <code class="docutils literal notranslate"><span class="pre">sub-1/func</span></code> looks like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">onset</span>   <span class="n">duration</span>        <span class="n">trial_type</span>
<span class="mf">12.000</span>  <span class="mf">0.500</span>   <span class="n">scissors</span>
<span class="mf">14.000</span>  <span class="mf">0.500</span>   <span class="n">scissors</span>
<span class="mf">16.000</span>  <span class="mf">0.500</span>   <span class="n">scissors</span>
<span class="mf">18.000</span>  <span class="mf">0.500</span>   <span class="n">scissors</span>
<span class="mf">20.000</span>  <span class="mf">0.500</span>   <span class="n">scissors</span>
<span class="mf">22.000</span>  <span class="mf">0.500</span>   <span class="n">scissors</span>
<span class="mf">24.000</span>  <span class="mf">0.500</span>   <span class="n">scissors</span>
<span class="mf">26.000</span>  <span class="mf">0.500</span>   <span class="n">scissors</span>
<span class="mf">28.000</span>  <span class="mf">0.500</span>   <span class="n">scissors</span>
<span class="mf">30.000</span>  <span class="mf">0.500</span>   <span class="n">scissors</span>
<span class="mf">32.000</span>  <span class="mf">0.500</span>   <span class="n">scissors</span>
<span class="mf">34.000</span>  <span class="mf">0.500</span>   <span class="n">scissors</span>
<span class="mf">48.000</span>  <span class="mf">0.500</span>   <span class="n">face</span>
<span class="mf">50.000</span>  <span class="mf">0.500</span>   <span class="n">face</span>
<span class="mf">52.000</span>  <span class="mf">0.500</span>   <span class="n">face</span>
<span class="mf">54.000</span>  <span class="mf">0.500</span>   <span class="n">face</span>
<span class="mf">56.000</span>  <span class="mf">0.500</span>   <span class="n">face</span>
<span class="mf">58.000</span>  <span class="mf">0.500</span>   <span class="n">face</span>
<span class="mf">60.000</span>  <span class="mf">0.500</span>   <span class="n">face</span>
<span class="mf">62.000</span>  <span class="mf">0.500</span>   <span class="n">face</span>
<span class="mf">64.000</span>  <span class="mf">0.500</span>   <span class="n">face</span>
<span class="mf">66.000</span>  <span class="mf">0.500</span>   <span class="n">face</span>
<span class="mf">68.000</span>  <span class="mf">0.500</span>   <span class="n">face</span>
<span class="mf">70.000</span>  <span class="mf">0.500</span>   <span class="n">face</span>
</pre></div>
</div>
<p>According to the Haxby et al. 2001 paper, each condition lasted for 24 seconds, and this is reflected in the Duration field that we specified in the last chapter. We will therefore need to extract the first onset time for each condition for each run, and concatenate them into a single timing file per condition. Later, we will use this timing file to fill in the remaining fields of our script.</p>
<p>The following code will extract the first onset time for each condition automatically, looping over all of the subjects in the dataset. You can either copy and paste this into the terminal, first making sure you are in the directory <code class="docutils literal notranslate"><span class="pre">Haxby_Data</span></code> that contains all of the subjects; else, you can copy it into a file, name it <code class="docutils literal notranslate"><span class="pre">make_Timings.sh</span></code>, and run it by typing <code class="docutils literal notranslate"><span class="pre">bash</span> <span class="pre">make_Timings.sh</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>#!/bin/bash
for subj in sub-1 sub-2 sub-3 sub-4 sub-5 sub-6; do
  cd ${subj}/func
    for cond in bottle cat chair face house scissors scrambledpix shoe; do
      if [ -f &quot;$cond.txt&quot; ]; then
        rm ${cond}.txt
      fi
          for i in `seq -w 1 12`; do
                  cat ${subj}_task-objectviewing_run-${i}_events.tsv | awk -v i=&quot;$cond&quot; &#39;{if ($3==i) print $1}&#39; | head -1 &gt;&gt; ${cond}.txt
          done
    done
  cd ../..
done

(Note that errors for subject 5 run 12 are expected, and will be dealt with later.)
</pre></div>
</div>
<p>This will generate files labeled <code class="docutils literal notranslate"><span class="pre">bottle.txt</span></code>, <code class="docutils literal notranslate"><span class="pre">cat.txt</span></code>, and so on, one for each condition, and place it in the appropriate subject’s <code class="docutils literal notranslate"><span class="pre">func</span></code> folder. The contents of sub-1’s <code class="docutils literal notranslate"><span class="pre">bottle.txt</span></code> file, for example, will look like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">228.000</span>
<span class="mf">192.000</span>
<span class="mf">156.000</span>
<span class="mf">228.000</span>
<span class="mf">84.000</span>
<span class="mf">228.000</span>
<span class="mf">264.000</span>
<span class="mf">156.000</span>
<span class="mf">228.000</span>
<span class="mf">264.000</span>
<span class="mf">120.000</span>
<span class="mf">12.000</span>
</pre></div>
</div>
<p>Note that these onset times are relative to the start of each run. For example, the first value of 228.000 means that the “bottle” condition occurred 228 seconds into the first run; the next value indicates that 192.000 seconds into the second run was when the “bottle” condition was next presented; and so on.</p>
</section>
<section id="modifying-the-script">
<h2>Modifying the Script<a class="headerlink" href="#modifying-the-script" title="Link to this heading"></a></h2>
<p>In the previous chapter, we created a template script from the SPM GUI and labeled it <code class="docutils literal notranslate"><span class="pre">Haxby_Script</span></code>. This created two separate scripts, <code class="docutils literal notranslate"><span class="pre">Haxby_Script_job.m</span></code> which contains the SPM code that runs all of the commands specified in the GUI, and <code class="docutils literal notranslate"><span class="pre">Haxby_Script.m</span></code>, which contains the command <code class="docutils literal notranslate"><span class="pre">spm_jobman</span></code> which executes the file <code class="docutils literal notranslate"><span class="pre">Haxby_Script_job.m</span></code>. We will be editing the latter in order to read the timing files that we just created; to open it, from the Matlab terminal type <code class="docutils literal notranslate"><span class="pre">open</span> <span class="pre">Haxby_Script_job.m</span></code> (or click the <code class="docutils literal notranslate"><span class="pre">Open</span></code> button and select the script).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This section draws upon many of the same principles discussed in the SPM chapter on <a class="reference internal" href="../../SPM/SPM_Short_Course/SPM_06_Scripting.html#spm-06-scripting"><span class="std std-ref">scripting</span></a>. If you haven’t already, it may help to work through the entire SPM tutorial in order to develop a foundation for what we will learn next.</p>
</div>
<p>Around line 58 is where the fMRI specification module is defined. Before the onset times are defined, enter the following code (I place this at lines 64-65 in my script):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;sub-1/func/bottle.txt&#39;</span><span class="p">);</span> <span class="n">load</span><span class="p">(</span><span class="s1">&#39;sub-1/func/cat.txt&#39;</span><span class="p">);</span> <span class="n">load</span><span class="p">(</span><span class="s1">&#39;sub-1/func/chair.txt&#39;</span><span class="p">);</span> <span class="n">load</span><span class="p">(</span><span class="s1">&#39;sub-1/func/face.txt&#39;</span><span class="p">);</span>
<span class="n">load</span><span class="p">(</span><span class="s1">&#39;sub-1/func/house.txt&#39;</span><span class="p">);</span> <span class="n">load</span><span class="p">(</span><span class="s1">&#39;sub-1/func/scissors.txt&#39;</span><span class="p">);</span> <span class="n">load</span><span class="p">(</span><span class="s1">&#39;sub-1/func/scrambledpix.txt&#39;</span><span class="p">);</span> <span class="n">load</span><span class="p">(</span><span class="s1">&#39;sub-1/func/shoe.txt&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>This will load each text file for <code class="docutils literal notranslate"><span class="pre">sub-1</span></code> into a variable. Usually the variable is defined by typing something like <code class="docutils literal notranslate"><span class="pre">x=load(bottle.txt)</span></code>, which assigns the values in <code class="docutils literal notranslate"><span class="pre">bottle.txt</span></code> to <code class="docutils literal notranslate"><span class="pre">x</span></code>. If no variable is defined on the left side of the equation, then the variable will default to the name of the text file that is loaded. In this case, the variables will be labeled <code class="docutils literal notranslate"><span class="pre">bottle</span></code>, <code class="docutils literal notranslate"><span class="pre">cat</span></code>, and so on.</p>
<p>Remember that when we created this script in the GUI, we left the onset times undefined. In the script, you will see the string <code class="docutils literal notranslate"><span class="pre">&lt;UNDEFINED&gt;</span></code> that was not filled in from the GUI; we will replace these with the appropriate values from the text files that we just loaded.</p>
<p>For example, the first onset field in my script is at line 67. Since this is the onset time for the <code class="docutils literal notranslate"><span class="pre">bottle</span></code> condition for run 1, I will need to extract the first row of the file <code class="docutils literal notranslate"><span class="pre">bottle.txt</span></code>. I can assign it to this field by replacing <code class="docutils literal notranslate"><span class="pre">&lt;UNDEFINED&gt;</span></code> with <code class="docutils literal notranslate"><span class="pre">bottle(1,:)</span></code>. (You can double-check what value is being assigned by typing <code class="docutils literal notranslate"><span class="pre">bottle(1,:)</span></code> at the Matlab terminal.) We will then do this for the other conditions as well, which you can see in the figure below:</p>
<figure class="align-default" id="id1">
<img alt="../../_images/04_Script_Timings.png" src="../../_images/04_Script_Timings.png" />
<figcaption>
<p><span class="caption-text">Snapshot of part of the script to analyze the Haxby dataset. The timing files are loaded, and then the appropriate line is extracted and inserted into the onset times field for each run.</span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>These need to be replaced for each condition for the first run, and then done for each of the other runs. Again, this is tedious, but you will see that once we’ve done it once, with slight modifications we can run it for all of the other subjects. When we fill in the onset times for the other fields, we will need to extract the correct row; for the second run, for example, the code to extract the onset times for the bottle condition would be <code class="docutils literal notranslate"><span class="pre">bottle(2,:)</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you are uncertain about how to fill in the rest of the fields, a copy of the script can be downloaded <a class="reference external" href="https://github.com/andrewjahn/MachineLearning/blob/main/Haxby_Script_job.m">here</a>.</p>
</div>
<p>Lastly, add this line to the end of the script in order to run the code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">spm_jobman</span><span class="p">(</span><span class="s1">&#39;run&#39;</span><span class="p">,</span> <span class="n">matlabbatch</span><span class="p">)</span>
</pre></div>
</div>
<p>And then run the script from the terminal by tying the name of the script:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Haxby_Script_job</span>
</pre></div>
</div>
<p>It should take about an hour to run.</p>
</section>
<section id="video">
<h2>Video<a class="headerlink" href="#video" title="Link to this heading"></a></h2>
<p>For an overview of how to create the timing files for this study, click <a class="reference external" href="https://www.youtube.com/watch?v=Fv3KAPW8Kd0">here</a>.</p>
</section>
<section id="next-steps">
<h2>Next Steps<a class="headerlink" href="#next-steps" title="Link to this heading"></a></h2>
<p>When the script has finished, you should see a design matrix that looks like this:</p>
<figure class="align-default">
<img alt="../../_images/04_Design_Matrix.png" src="../../_images/04_Design_Matrix.png" />
</figure>
<p>Each run should look like a separate square, with the tiny white squares within each run representing a block for each condition. Each of these blocks has been estimated as a separate beta map, which we will use as both training and testing data for our classifier. To learn how to do that, click the <code class="docutils literal notranslate"><span class="pre">Next</span></code> button.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="ML_03_Haxby_Preprocessing.html" class="btn btn-neutral float-left" title="Machine Learning Tutorial #3: Preprocessing" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="ML_05_Haxby_MVPA.html" class="btn btn-neutral float-right" title="Machine Learning Tutorial #5: MVPA Analysis with The Decoding Toolbox" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Andy Jahn.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>