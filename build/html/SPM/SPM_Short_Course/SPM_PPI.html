<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Appendix B: Psychophysiological Interactions (PPI) in SPM &mdash; Andy&#39;s Brain Book 1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b76e3c8a" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=f2a433a1"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Appendix C: Parametric Modulation" href="AppendixC_ParametricModulation.html" />
    <link rel="prev" title="Appendix A: Summary Statistics" href="SummaryStatistics.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Andy's Brain Book
          </a>
              <div class="version">
                1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Install</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../installation/fsl_mac_install.html">Overview</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Unix for Neuroimagers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_Intro.html">What is Unix?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_01_Navigation.html">Unix Tutorial #1: 目录操作 (Directories and Navigation)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_02_CopyRemove.html">Unix Tutorial #2: Copying and Removing Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_03_ReadingTextFiles.html">Unix Tutorial #3: Reading Text Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_04_ShellsVariables.html">Unix Tutorial #4: Shells and Path Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_05_ForLoops.html">Unix Tutorial #5: For-Loops</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_06_IfElse.html">Unix Tutorial #6: Conditional Statements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_07_Scripting.html">Unix Tutorial #7: Scripting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_08_Sed.html">Unix Tutorial #8: The Sed Command</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_09_AutomatingTheAnalysis.html">Unix Tutorial #9: Automating The Analysis</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">fMRI Short Course with FSL</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_Intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_01_DataDownload.html">fMRI Tutorial #1: Downloading the Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_02_ExperimentalDesign.html">fMRI Tutorial #2: Overview of The Flanker Task</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_03_LookingAtTheData.html">fMRI Tutorial #3: Looking at the Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_04_Preprocessing.html">fMRI Tutorial #4: Preprocessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_05_1stLevelAnalysis.html">fMRI Tutorial #5: Statistics and Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_06_Scripting.html">fMRI Tutorial #6: Scripting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_07_2ndLevelAnalysis.html">fMRI Tutorial #7: 2nd-Level Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_08_3rdLevelAnalysis.html">fMRI Tutorial #8: 3rd-Level Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_09_ROIAnalysis.html">fMRI Tutorial #9: ROI Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_10_Summary.html">fMRI Tutorial #10: Summary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_Appendices.html">fMRI Short Course: Appendices</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">FreeSurfer</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../FreeSurfer/FreeSurfer_Introduction.html">FreeSurfer Short Course</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">E-Prime</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../E-Prime/E-Prime_Overview.html">Overview of E-Prime</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">AFNI</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../AFNI/AFNI_Overview.html">AFNI Overview</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">SPM</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../SPM_Overview.html">SPM Overview</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../SPM_Overview.html#what-is-spm">What is SPM?</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="SPM_fMRI_Intro.html">Introduction to SPM</a></li>
<li class="toctree-l3"><a class="reference internal" href="SPM_01_DataDownload.html">SPM Tutorial #1: Downloading the Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="SPM_02_Flanker.html">SPM Tutorial #2: The Flanker Task</a></li>
<li class="toctree-l3"><a class="reference internal" href="SPM_03_LookingAtData.html">SPM Tutorial #3: Looking at the Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="SPM_04_Preprocessing.html">SPM Tutorial #4: Preprocessing</a></li>
<li class="toctree-l3"><a class="reference internal" href="SPM_05_1stLevelAnalysis.html">SPM Tutorial #5: Statistics and Modeling</a></li>
<li class="toctree-l3"><a class="reference internal" href="SPM_06_Scripting.html">SPM Tutorial #6: Scripting</a></li>
<li class="toctree-l3"><a class="reference internal" href="SPM_07_SettingTheOrigin.html">SPM Tutorial #7: Setting the Origin</a></li>
<li class="toctree-l3"><a class="reference internal" href="SPM_08_GroupAnalysis.html">SPM Tutorial #8: Group Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="SPM_Intermezzo_Toolboxes.html">SPM Intermezzo: Toolboxes</a></li>
<li class="toctree-l3"><a class="reference internal" href="SPM_09_ROIAnalysis.html">SPM Tutorial #9: ROI Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="SummaryStatistics.html">Appendix A: Summary Statistics</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Appendix B: Psychophysiological Interactions (PPI) in SPM</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#download">Download</a></li>
<li class="toctree-l4"><a class="reference internal" href="#data-structure">Data Structure</a></li>
<li class="toctree-l4"><a class="reference internal" href="#preparing-for-the-ppi-analysis">Preparing for the PPI Analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="#setting-up-the-ppi-analysis">Setting up the PPI Analysis</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="AppendixC_ParametricModulation.html">Appendix C: Parametric Modulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="AppendixD_DesignOptimization.html">Appendix D: DesignOptimization</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Functional Connectivity with the CONN Toolbox</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../FunctionalConnectivity/CONN_Overview.html">Functional Connectivity and the CONN Toolbox</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Parametric Modulation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../PM/PM_Overview.html">Parametric Modulation in SPM, FSL, and AFNI</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Image Visualization with MRIcroGL</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../MRIcroGL/MRIcroGL_Overview.html">Image Visualization with MRIcroGL</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Introduction to the Human Connectome Project (HCP)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../HCP/HCP_Overview.html">Introduction to the Human Connectome Project</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Finite Impulse Response (FIR) Models</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../FIR/FIR_Overview.html">Finite Impulse Response (FIR)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">fMRI Concepts</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Practicals/DesignOptimization.html">Design Optimization</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Diffusion Analysis with MRtrix</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../MRtrix/MRtrix_Introduction.html">Introduction to MRtrix</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ASL Analysis</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../ASL/ASL_Techniques.html">fASL Tutorial #1: Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ASL/fASL_02_Download.html">fASL Tutorial #2: Downloading and Installing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ASL/fASL_03_Task.html">fASL Tutorial #3: The N-Back Task</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ASL/04_fASL_GUI.html">fASL Tutorial #4: The GUI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ASL/05_fASL_Results.html">fASL Tutorial #5: Examining the Results</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ASL/06_fASL_Quantification.html">fASL Tutorial #6: Quantification</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Frequently Asked Questions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../FrequentlyAskedQuestions/FrequentlyAskedQuestions.html">Frequently Asked Questions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Statistics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Statistics/GIMME.html">GIMME (Group Iterative Multiple Model Estimation)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Open Science</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../OpenScience/OS_Overview.html">Open Science</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced Normalization Tools (ANTs)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../ANTs/ANTs_Overview.html">Advanced Normalization Tools (ANTs)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tract-Based Spatial Statistics (TBSS)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../TBSS/TBSS_Overview.html">Introduction to Tract-Based Spatial Statistics (TBSS)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Statistics for Neuroimagers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Stats/Stats_Overview.html">Statistics for Neuroimagers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Machine Learning for Neuroimagers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../ML/ML_Overview.html">Machine Learning for Neuroimagers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Slicer</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Slicer/Slicer_Overview.html">Slicer Overview</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">CAT12</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../CAT12/CAT12_Overview.html">Voxel-Based Morphometry with CAT12</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Using the Supercomputer</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Supercomputer/Supercomputer_Overview.html">Introduction to Supercomputing</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Matlab for Neuroimagers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Matlab/Matlab_Overview.html">Matlab for Neuroimagers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ITK-Snap</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../ITK-Snap/ITK-Snap_Overview.html">ITK-Snap_Overview</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Python for Neuroimagers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../PythonForNeuroimagers/PythonForNeuroimagers_Overview.html">Python for Neuroimagers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Meta-Analysis for fMRI</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../MetaAnalysis/MetaAnalysis_Overview.html">Meta-Analysis for Neuroimagers</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Andy's Brain Book</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../SPM_Overview.html">SPM Overview</a></li>
      <li class="breadcrumb-item active">Appendix B: Psychophysiological Interactions (PPI) in SPM</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/SPM/SPM_Short_Course/SPM_PPI.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="appendix-b-psychophysiological-interactions-ppi-in-spm">
<span id="spm-ppi"></span><h1>Appendix B: Psychophysiological Interactions (PPI) in SPM<a class="headerlink" href="#appendix-b-psychophysiological-interactions-ppi-in-spm" title="Link to this heading"></a></h1>
<hr class="docutils" />
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This page is currently where I am jotting down notes for how to do a group-level PPI in SPM, and is still under construction.</p>
</div>
<section id="download">
<h2>Download<a class="headerlink" href="#download" title="Link to this heading"></a></h2>
<p>Data is from the <a class="reference external" href="https://db.humanconnectome.org/">Human Connectome Project database</a>; click on the dropdown menu next to WU-Minn HCP Data - 1200 subjects and select <cite>subjects with 3T MR Session Data</cite>.</p>
</section>
<section id="data-structure">
<h2>Data Structure<a class="headerlink" href="#data-structure" title="Link to this heading"></a></h2>
<p>Within each subject directory (with subject IDs like 100206), there is a directory called <cite>MNINonLinear/Results</cite>. This contains 2 directories with functional data, tfMRI_SOCIAL_LR and tfMRI_SOCIAL_RL. The data have been preprocessed, except for the smoothing step; you will need to apply that yourself.</p>
<p>Before you begin, create the following directories in each subject’s folder with Matlab’s <code class="docutils literal notranslate"><span class="pre">mkdir</span></code> command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span><span class="n">stLevel_Concat</span>
<span class="n">PPI</span>
</pre></div>
</div>
</section>
<section id="preparing-for-the-ppi-analysis">
<h2>Preparing for the PPI Analysis<a class="headerlink" href="#preparing-for-the-ppi-analysis" title="Link to this heading"></a></h2>
<p>Once the data have been smoothed, the directories will contain files called “stfMRI_SOCIAL_LR.nii” and “stfMRI_SOCIAL_RL.nii”. We will be combining these into a single dataset, because SPM’s PPI function cannot process datasets with more than one run. To account for the fact that we are combining all of the data into one run, and that the signal may be systematically different in one run compared to another, we will be including <em>both</em> in our 1st level analysis.</p>
<section id="concatenating-the-movement-regressors">
<h3>Concatenating the Movement Regressors<a class="headerlink" href="#concatenating-the-movement-regressors" title="Link to this heading"></a></h3>
<p>The movement regressors will also need to be vertically concatenated into a single file. Navigate into the tfMRI_SOCIAL_LR directory and type:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cat</span> <span class="n">Movement_Regressors</span><span class="o">.</span><span class="n">txt</span> <span class="o">../</span><span class="n">tfMRI_SOCIAL_RL</span><span class="o">/</span><span class="n">Movement_Regressors</span><span class="o">.</span><span class="n">txt</span> <span class="o">&gt;</span> <span class="n">allMovement_Regressors</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
</section>
<section id="creating-the-model-specification-batch">
<h3>Creating the Model Specification Batch<a class="headerlink" href="#creating-the-model-specification-batch" title="Link to this heading"></a></h3>
<p>In this study, the TR is 0.72, and each run has 274 volumes. That means that each run is 0.72 * 274 = <strong>197.28 seconds</strong> long. We will therefore add 197.28 to the second run’s timings to generate the following onset times for a single concatenated run:</p>
<p>Mental:
8.21
122.056
205.476
243.287
319.336</p>
<p>Rnd:
46.008
84.032
160.081
281.311
357.36</p>
<p>Each onset time lasts for 23 seconds (i.e., this is a block design). There may be discrepancies of a few thousandth of a millisecond between subjects, but since it is a block design, this timing scheme can be used for every subject.</p>
<p>Now open the SPM GUI, click on <code class="docutils literal notranslate"><span class="pre">Batch</span></code>, and from the menu click on <code class="docutils literal notranslate"><span class="pre">SPM</span> <span class="pre">-&gt;</span> <span class="pre">Stats</span> <span class="pre">-&gt;</span> <span class="pre">fMRI</span> <span class="pre">model</span> <span class="pre">specification</span></code>. Add the following modules, also in the SPM -&gt; Stats menu: <code class="docutils literal notranslate"><span class="pre">Model</span> <span class="pre">estimation</span></code> and <code class="docutils literal notranslate"><span class="pre">Contrast</span> <span class="pre">Manager</span></code>.</p>
<p>In the fMRI model specification module, select the <code class="docutils literal notranslate"><span class="pre">1stLevel_Concat</span></code> folder as the Directory. Change the Units for design to <code class="docutils literal notranslate"><span class="pre">Seconds</span></code>, and the Interscan interval to <code class="docutils literal notranslate"><span class="pre">0.72</span></code>. Click on <code class="docutils literal notranslate"><span class="pre">Data</span> <span class="pre">&amp;</span> <span class="pre">Design</span></code> and then select <code class="docutils literal notranslate"><span class="pre">New:</span> <span class="pre">Subject/Session</span></code>. Double-click on the <code class="docutils literal notranslate"><span class="pre">Scans</span></code> button, and select the stfMRI_SOCIAL_LR.nii files <em>first</em>, and then the stfMRI_SOCIAL_RL.nii files (this order is important). In the selection window, enter <code class="docutils literal notranslate"><span class="pre">^s.*</span></code> in the Filter field to only view those files beginning with an ‘s’, and in the Frames field type <code class="docutils literal notranslate"><span class="pre">1:274</span></code> to expand the number of volumes to 274. Do this for each of the LR and RL directories.</p>
<p>Now click on <code class="docutils literal notranslate"><span class="pre">Conditions</span></code>, and click twice on <code class="docutils literal notranslate"><span class="pre">New:Condition</span></code>. Rename the first condition <code class="docutils literal notranslate"><span class="pre">Mental</span></code>, and the second condition <code class="docutils literal notranslate"><span class="pre">Rnd</span></code>. Specify a duration of <code class="docutils literal notranslate"><span class="pre">23</span></code> for both, and in the <code class="docutils literal notranslate"><span class="pre">Onsets</span></code> field, copy and paste the above timings for each corresponding condition.</p>
<p>To account for the effect of block, click on <code class="docutils literal notranslate"><span class="pre">Regressors</span></code>, and select <code class="docutils literal notranslate"><span class="pre">New:</span> <span class="pre">Regressor</span></code>. Set the Name to <code class="docutils literal notranslate"><span class="pre">block1</span></code>, and then double-click on <code class="docutils literal notranslate"><span class="pre">Value</span></code>. In the Value field, type the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">kron</span><span class="p">([</span><span class="mi">1</span> <span class="mi">0</span><span class="p">]</span><span class="s1">&#39;,ones(274,1))</span>
</pre></div>
</div>
<p>Which will create a column vector with 274 ones, followed by 274 zeros. These represent the first block and the second block, respectively.</p>
<p>Finally, click on <code class="docutils literal notranslate"><span class="pre">Multiple</span> <span class="pre">regressors</span></code>, and load the <code class="docutils literal notranslate"><span class="pre">allMovement_Regressors.txt</span></code> file that you created above. When you have finished, your model specification should look like this:</p>
<figure class="align-default">
<img alt="../../_images/SPM_PPI_ModelSpecification.png" src="../../_images/SPM_PPI_ModelSpecification.png" />
</figure>
<p>Now we will finish editing the other modules in our batch. Click on <code class="docutils literal notranslate"><span class="pre">Model</span> <span class="pre">estimation</span></code> in the lefthand window, highlight <code class="docutils literal notranslate"><span class="pre">Select</span> <span class="pre">SPM.mat</span></code> with your mouse, and then click on <code class="docutils literal notranslate"><span class="pre">Dependency</span></code>. Choose the SPM.mat file from the fMRI model specification step.</p>
<figure class="align-default">
<img alt="../../_images/SPM_PPI_ModelEstimation.png" src="../../_images/SPM_PPI_ModelEstimation.png" />
</figure>
<p>Next, click on the <code class="docutils literal notranslate"><span class="pre">Contrast</span> <span class="pre">Manager</span></code> module. Again, highlight <code class="docutils literal notranslate"><span class="pre">Select</span> <span class="pre">SPM.mat</span></code> with your mouse, and then click on <code class="docutils literal notranslate"><span class="pre">Dependency</span></code>. Choose the SPM.mat file from the model <em>estimation</em> step. Then click on <code class="docutils literal notranslate"><span class="pre">Contrast</span> <span class="pre">Sessions</span></code> and click on <code class="docutils literal notranslate"><span class="pre">New:</span> <span class="pre">T-contrast</span></code> to create three new T-contrasts. Label the first one <code class="docutils literal notranslate"><span class="pre">Mental</span></code>, the second one <code class="docutils literal notranslate"><span class="pre">Rnd</span></code>, and the third one <code class="docutils literal notranslate"><span class="pre">Mental-Rnd</span></code>. For the Mental contrast, specify a vector of [1 0]; for the Rnd contrast, specify a vector of [0 1]. For the Mental-Rnd contrast, specify a vector of [1 -1]. Since there is only one run, you do not need to Replicate&amp;Scale the contrast weights, but doing so won’t affect your analysis either.</p>
<figure class="align-default">
<img alt="../../_images/SPM_PPI_ContrastManager.png" src="../../_images/SPM_PPI_ContrastManager.png" />
</figure>
<p>Now save the batch and script by clicking on <code class="docutils literal notranslate"><span class="pre">File</span> <span class="pre">-&gt;</span> <span class="pre">Save</span> <span class="pre">Batch</span> <span class="pre">and</span> <span class="pre">Script</span></code>. Label the output <code class="docutils literal notranslate"><span class="pre">Sample_Concatenated_1stLevel</span></code>. Then click on the green “Play” button in the top left corner of the GUI to run the batch. It should take about 15-20 minutes. When it has finished, the design matrix should look like the following:</p>
<figure class="align-default">
<img alt="../../_images/SPM_PPI_DesignMatrix.png" src="../../_images/SPM_PPI_DesignMatrix.png" />
</figure>
</section>
<section id="the-ppi-interface">
<h3>The PPI Interface<a class="headerlink" href="#the-ppi-interface" title="Link to this heading"></a></h3>
<p>We are now ready to begin our PPI analysis. Before you start, make sure that you have a region of interest (or ROI, also known as a mask) to use. These can be created either using Marsbar or another software package, such as AFNI’s 3dUndump or FSL’s fslmaths. In our example, assume you’ve created an ROI called dmPFC that is centered within the dorsomedial prefrontal cortex. These ROIs will be stored in the directory that contains all of the subject directories.</p>
<p>To begin, open the SPM GUI and click on the <code class="docutils literal notranslate"><span class="pre">PPIs</span></code> button. You will be prompted to select an SPM.mat file; select the one you just created that is located in the <code class="docutils literal notranslate"><span class="pre">1stLevel_Concat</span></code> directory. You will then be prompted to select an analysis type; choose <code class="docutils literal notranslate"><span class="pre">psychophysiologic</span> <span class="pre">interaction</span></code> and then select <code class="docutils literal notranslate"><span class="pre">VOI_dmPFC.mat</span></code>. Include <code class="docutils literal notranslate"><span class="pre">Mental</span></code> and <code class="docutils literal notranslate"><span class="pre">Rnd</span></code> when prompted, and assign them weights of 1 and -1, respectively. Label the output PPI as <code class="docutils literal notranslate"><span class="pre">PPI</span></code>.</p>
<p>You will then see a window showing the hemodynamic and estimated neuronal responses (after the hemodynamic response has been deconvolved), and the onset times of the blocks of your experiment, convolved with the HRF.</p>
<figure class="align-default">
<img alt="../../_images/SPM_PPI_SummaryPage.png" src="../../_images/SPM_PPI_SummaryPage.png" />
</figure>
<p>This will create a variable in your workspace called <code class="docutils literal notranslate"><span class="pre">PPI</span></code>. You can load it from the command line by typing <code class="docutils literal notranslate"><span class="pre">load</span> <span class="pre">PPI</span></code>. This enables the use of several fields of the PPI variable, including:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">PPI</span><span class="o">.</span><span class="n">P</span><span class="p">:</span> <span class="n">The</span> <span class="n">convolved</span> <span class="n">onset</span> <span class="n">times</span>
<span class="n">PPI</span><span class="o">.</span><span class="n">Y</span><span class="p">:</span> <span class="n">The</span> <span class="n">time</span><span class="o">-</span><span class="n">series</span> <span class="n">extracted</span> <span class="kn">from</span> <span class="nn">the</span> <span class="n">VOI</span>
<span class="n">PPI</span><span class="o">.</span><span class="n">ppi</span><span class="p">:</span> <span class="n">The</span> <span class="n">Interaction</span> <span class="n">term</span> <span class="n">created</span> <span class="n">by</span> <span class="n">the</span> <span class="n">PPI</span> <span class="n">analysis</span>
</pre></div>
</div>
<p>Our goal is to now include these three variables in another GLM, which will allow us to estimate a beta weight at each voxel for the PPI using a VOI (in this case, the dmPFC).</p>
</section>
</section>
<section id="setting-up-the-ppi-analysis">
<h2>Setting up the PPI Analysis<a class="headerlink" href="#setting-up-the-ppi-analysis" title="Link to this heading"></a></h2>
<p>First, enable the use of the PPI fields by typing the following at the Matlab prompt:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">load</span> <span class="n">PPI_PPI</span><span class="o">.</span><span class="n">mat</span>
</pre></div>
</div>
<p>You should see the variable <code class="docutils literal notranslate"><span class="pre">PPI</span></code> in your workspace.</p>
<p>Now, open the SPM GUI and click the <code class="docutils literal notranslate"><span class="pre">Batch</span></code> button. As before, from the menu click on <code class="docutils literal notranslate"><span class="pre">SPM</span> <span class="pre">-&gt;</span> <span class="pre">Stats</span> <span class="pre">-&gt;</span> <span class="pre">fMRI</span> <span class="pre">model</span> <span class="pre">specification</span></code>. Add the following modules, also in the SPM -&gt; Stats menu: <code class="docutils literal notranslate"><span class="pre">Model</span> <span class="pre">estimation</span></code> and <code class="docutils literal notranslate"><span class="pre">Contrast</span> <span class="pre">Manager</span></code>.</p>
<p>In the fMRI model specification module, set up the model as previously: Units of Time in Seconds and TR of 0.72, and the same Scans as before. Select the folder <code class="docutils literal notranslate"><span class="pre">PPI</span></code> as the output directory. Then click on <code class="docutils literal notranslate"><span class="pre">Data</span> <span class="pre">&amp;</span> <span class="pre">Design</span></code>, and click on <code class="docutils literal notranslate"><span class="pre">New:</span> <span class="pre">Subject/Session</span></code>. Instead of conditions, however, this time we will enter Regressors, since they have already been convolved with the hemodynamic response function. Create 4 new Regressors, and give them the following names and values:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Regressor</span> <span class="mi">1</span><span class="p">:</span> <span class="n">Name</span><span class="o">=</span><span class="n">PPI_Interaction</span> <span class="o">/</span> <span class="n">Value</span><span class="o">=</span><span class="n">PPI</span><span class="o">.</span><span class="n">ppi</span>
<span class="n">Regressor</span> <span class="mi">2</span><span class="p">:</span> <span class="n">Name</span><span class="o">=</span><span class="n">dmPFC_BOLD</span> <span class="o">/</span> <span class="n">Value</span><span class="o">=</span><span class="n">PPI</span><span class="o">.</span><span class="n">Y</span>
<span class="n">Regressor</span> <span class="mi">3</span><span class="p">:</span> <span class="n">Name</span><span class="o">=</span><span class="n">Mental</span><span class="o">-</span><span class="n">Rnd</span> <span class="o">/</span> <span class="n">Value</span><span class="o">=</span><span class="n">PPI</span><span class="o">.</span><span class="n">P</span>
<span class="n">Regressor</span> <span class="mi">4</span><span class="p">:</span> <span class="n">Name</span><span class="o">=</span><span class="n">block1</span> <span class="o">/</span> <span class="n">Value</span><span class="o">=</span><span class="n">kron</span><span class="p">([</span><span class="mi">1</span> <span class="mi">0</span><span class="p">]</span><span class="s1">&#39;,ones(274,1))</span>
</pre></div>
</div>
<p>Also double-click on <code class="docutils literal notranslate"><span class="pre">Multiple</span> <span class="pre">regressors</span></code> and specify the allMovement_Regressors.txt file. When you are finished, the model specification window should look like this:</p>
<figure class="align-default">
<img alt="../../_images/SPM_PPI_Model_Specification_PPI.png" src="../../_images/SPM_PPI_Model_Specification_PPI.png" />
</figure>
<p>Set the Model estimation SPM file to a dependency calling upon the output from the fMRI model specification module, and specify the SPM file in the Contrast manager as the dependency output from the Model estimation module. In the Contrast Manager module, create one T-contrast, and give it the name <code class="docutils literal notranslate"><span class="pre">dmPFC_PPI_Interaction</span></code>. Give it a weight vector of <code class="docutils literal notranslate"><span class="pre">1</span></code>. Then save the batch and script as <code class="docutils literal notranslate"><span class="pre">Run_dmPFC_PPI</span></code> in the results directory which contains the 1stLevel_Concat and PPI folders. Then press the green “play” button to run the analysis.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="SummaryStatistics.html" class="btn btn-neutral float-left" title="Appendix A: Summary Statistics" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="AppendixC_ParametricModulation.html" class="btn btn-neutral float-right" title="Appendix C: Parametric Modulation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Andy Jahn.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>