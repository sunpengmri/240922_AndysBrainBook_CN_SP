<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Chapter #11: Task-Related Connectivity and gPPI &mdash; Andy&#39;s Brain Book 1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b76e3c8a" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=f2a433a1"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Chapter #12: Scripting" href="CONN_12_Scripting.html" />
    <link rel="prev" title="Chapter #10: Viewing the Results" href="CONN_10_Viewing_Results.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Andy's Brain Book
          </a>
              <div class="version">
                1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Install</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../installation/fsl_mac_install.html">Overview</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Unix for Neuroimagers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_Intro.html">What is Unix?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_01_Navigation.html">Unix Tutorial #1: 目录操作 (Directories and Navigation)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_02_CopyRemove.html">Unix Tutorial #2: Copying and Removing Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_03_ReadingTextFiles.html">Unix Tutorial #3: Reading Text Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_04_ShellsVariables.html">Unix Tutorial #4: Shells and Path Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_05_ForLoops.html">Unix Tutorial #5: For-Loops</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_06_IfElse.html">Unix Tutorial #6: Conditional Statements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_07_Scripting.html">Unix Tutorial #7: Scripting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_08_Sed.html">Unix Tutorial #8: The Sed Command</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_09_AutomatingTheAnalysis.html">Unix Tutorial #9: Automating The Analysis</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">fMRI Short Course with FSL</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_Intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_01_DataDownload.html">fMRI Tutorial #1: Downloading the Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_02_ExperimentalDesign.html">fMRI Tutorial #2: Overview of The Flanker Task</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_03_LookingAtTheData.html">fMRI Tutorial #3: Looking at the Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_04_Preprocessing.html">fMRI Tutorial #4: Preprocessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_05_1stLevelAnalysis.html">fMRI Tutorial #5: Statistics and Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_06_Scripting.html">fMRI Tutorial #6: Scripting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_07_2ndLevelAnalysis.html">fMRI Tutorial #7: 2nd-Level Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_08_3rdLevelAnalysis.html">fMRI Tutorial #8: 3rd-Level Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_09_ROIAnalysis.html">fMRI Tutorial #9: ROI Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_10_Summary.html">fMRI Tutorial #10: Summary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_Appendices.html">fMRI Short Course: Appendices</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">FreeSurfer</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../FreeSurfer/FreeSurfer_Introduction.html">FreeSurfer Short Course</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">E-Prime</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../E-Prime/E-Prime_Overview.html">Overview of E-Prime</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">AFNI</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../AFNI/AFNI_Overview.html">AFNI Overview</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">SPM</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../SPM/SPM_Overview.html">SPM Overview</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Functional Connectivity with the CONN Toolbox</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../CONN_Overview.html">Functional Connectivity and the CONN Toolbox</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../CONN_Overview.html#overview">Overview</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../CONN_Overview.html#recommended-tutorials">Recommended Tutorials</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="CONN_00_History.html">History of Functional Connectivity</a></li>
<li class="toctree-l3"><a class="reference internal" href="CONN_01_FSL_Demo.html">Chapter #1: Functional Connectivity Demonstration</a></li>
<li class="toctree-l3"><a class="reference internal" href="CONN_02_DataDownload.html">Chapter #2: Downloading the Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="CONN_03_LookingAtData.html">Chapter #3: Downloading the CONN Toolbox</a></li>
<li class="toctree-l3"><a class="reference internal" href="CONN_04_GUI_Overview.html">Chapter #4: The CONN GUI</a></li>
<li class="toctree-l3"><a class="reference internal" href="CONN_05_Preprocessing.html">Chapter #5: Preprocessing</a></li>
<li class="toctree-l3"><a class="reference internal" href="CONN_06_QA_Checks.html">Chapter #6: Quality Assurance Checks</a></li>
<li class="toctree-l3"><a class="reference internal" href="CONN_07_Denoising.html">Chapter #7: Denoising</a></li>
<li class="toctree-l3"><a class="reference internal" href="CONN_08_1stLevel_Analysis.html">Chapter #8: 1st-Level Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="CONN_09_2ndLevel_Analysis.html">Chapter #9: Group-level analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="CONN_10_Viewing_Results.html">Chapter #10: Viewing the Results</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Chapter #11: Task-Related Connectivity and gPPI</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#setting-up-a-gppi-in-the-conn-toolbox">Setting up a gPPI in the CONN Toolbox</a></li>
<li class="toctree-l4"><a class="reference internal" href="#viewing-the-results">Viewing the Results</a></li>
<li class="toctree-l4"><a class="reference internal" href="#generalized-functional-connectivity">Generalized Functional Connectivity</a></li>
<li class="toctree-l4"><a class="reference internal" href="#next-steps">Next Steps</a></li>
<li class="toctree-l4"><a class="reference internal" href="#video">Video</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="CONN_12_Scripting.html">Chapter #12: Scripting</a></li>
<li class="toctree-l3"><a class="reference internal" href="CONN_AppendixA_GraphTheory.html">Appendix A: Graph Theory</a></li>
<li class="toctree-l3"><a class="reference internal" href="CONN_AppendixB_OtherSecondLevelDesigns.html">Appendix B: Other Second-Level Analyses</a></li>
<li class="toctree-l3"><a class="reference internal" href="CONN_AppendixC_ImportingROIs.html">Appendix C: Importing ROIs</a></li>
<li class="toctree-l3"><a class="reference internal" href="CONN_AppendixD_SurfaceBasedConnectivity.html">Appendix D: Surface-Based Connectivity</a></li>
<li class="toctree-l3"><a class="reference internal" href="CONN_AppendixE_DynamicConnectivity.html">Appendix E: Dynamic Connectivity</a></li>
<li class="toctree-l3"><a class="reference internal" href="CONN_AppendixF_OpenScienceConnToolbox.html">Appendix F: Open Science and the CONN Toolbox</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Parametric Modulation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../PM/PM_Overview.html">Parametric Modulation in SPM, FSL, and AFNI</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Image Visualization with MRIcroGL</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../MRIcroGL/MRIcroGL_Overview.html">Image Visualization with MRIcroGL</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Introduction to the Human Connectome Project (HCP)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../HCP/HCP_Overview.html">Introduction to the Human Connectome Project</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Finite Impulse Response (FIR) Models</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../FIR/FIR_Overview.html">Finite Impulse Response (FIR)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">fMRI Concepts</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Practicals/DesignOptimization.html">Design Optimization</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Diffusion Analysis with MRtrix</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../MRtrix/MRtrix_Introduction.html">Introduction to MRtrix</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ASL Analysis</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../ASL/ASL_Techniques.html">fASL Tutorial #1: Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ASL/fASL_02_Download.html">fASL Tutorial #2: Downloading and Installing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ASL/fASL_03_Task.html">fASL Tutorial #3: The N-Back Task</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ASL/04_fASL_GUI.html">fASL Tutorial #4: The GUI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ASL/05_fASL_Results.html">fASL Tutorial #5: Examining the Results</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ASL/06_fASL_Quantification.html">fASL Tutorial #6: Quantification</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Frequently Asked Questions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../FrequentlyAskedQuestions/FrequentlyAskedQuestions.html">Frequently Asked Questions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Statistics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Statistics/GIMME.html">GIMME (Group Iterative Multiple Model Estimation)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Open Science</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../OpenScience/OS_Overview.html">Open Science</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced Normalization Tools (ANTs)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../ANTs/ANTs_Overview.html">Advanced Normalization Tools (ANTs)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tract-Based Spatial Statistics (TBSS)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../TBSS/TBSS_Overview.html">Introduction to Tract-Based Spatial Statistics (TBSS)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Statistics for Neuroimagers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Stats/Stats_Overview.html">Statistics for Neuroimagers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Machine Learning for Neuroimagers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../ML/ML_Overview.html">Machine Learning for Neuroimagers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Slicer</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Slicer/Slicer_Overview.html">Slicer Overview</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">CAT12</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../CAT12/CAT12_Overview.html">Voxel-Based Morphometry with CAT12</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Using the Supercomputer</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Supercomputer/Supercomputer_Overview.html">Introduction to Supercomputing</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Matlab for Neuroimagers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Matlab/Matlab_Overview.html">Matlab for Neuroimagers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ITK-Snap</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../ITK-Snap/ITK-Snap_Overview.html">ITK-Snap_Overview</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Python for Neuroimagers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../PythonForNeuroimagers/PythonForNeuroimagers_Overview.html">Python for Neuroimagers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Meta-Analysis for fMRI</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../MetaAnalysis/MetaAnalysis_Overview.html">Meta-Analysis for Neuroimagers</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Andy's Brain Book</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../CONN_Overview.html">Functional Connectivity and the CONN Toolbox</a></li>
      <li class="breadcrumb-item active">Chapter #11: Task-Related Connectivity and gPPI</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/FunctionalConnectivity/CONN_ShortCourse/CONN_11_Task_gPPI.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="chapter-11-task-related-connectivity-and-gppi">
<span id="conn-11-task-gppi"></span><h1>Chapter #11: Task-Related Connectivity and gPPI<a class="headerlink" href="#chapter-11-task-related-connectivity-and-gppi" title="Link to this heading"></a></h1>
<hr class="docutils" />
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading"></a></h2>
<p>Until now, we have analyzed <strong>resting-state</strong> data, in which the subject does nothing except remain still and awake. However, it is also common for studies to collect task-related data as well, in which the subject does some kind of activity; such as doing the <a class="reference internal" href="../../fMRI_Short_Course/fMRI_02_ExperimentalDesign.html#fmri-02-experimentaldesign"><span class="std std-ref">Flanker Task</span></a>, for example. In this chapter we will cover how to analyze task-related data by using a technique called <strong>Psychophysiological Interactions (PPI)</strong>, which reveals whether the functional connectivity between two nodes depends on what task the subject is currently doing.</p>
<figure class="align-default" id="id3">
<img alt="../../_images/11_gPPI_Example.jpg" src="../../_images/11_gPPI_Example.jpg" />
<figcaption>
<p><span class="caption-text">Example of a PPI analysis, taken from Outhred et al. (2015). The functional connectivity between the left amygdala seed region and the right IFG changes depending on which condition the subject is in.</span><a class="headerlink" href="#id3" title="Link to this image"></a></p>
</figcaption>
</figure>
<section id="traditional-ppis">
<h3>Traditional PPIs<a class="headerlink" href="#traditional-ppis" title="Link to this heading"></a></h3>
<p>Originally, a psychophysiological interaction consisted of modeling three terms (Friston, 1997):</p>
<ol class="arabic simple">
<li><p>A task regressor indicating which of two tasks the subject was currently doing;</p></li>
<li><p>A time-series regressor extracted from a seed region; and</p></li>
<li><p>An interaction term, consisting of the product of the task regressor multiplied by the time-series regressor.</p></li>
</ol>
<p>The interaction term was then tested for significance. In other words, a significant voxel would show differences in functional connectivity as a function of task. The figure below shows how these regressors are constructed:</p>
<figure class="align-default" id="id4">
<img alt="../../_images/11_PPI_Illustration.png" src="../../_images/11_PPI_Illustration.png" />
<figcaption>
<p><span class="caption-text">An illustration of PPI regressors. The top panel shows a binary regressor composed of 1’s and -1’s, indicating whether the subject is in one of two conditions. The middle panel shows a time-series extracted from a seed region. The bottom panel shows the interaction regressor, created by multiplying the above regressors. Note how the -1’s, when multiplied by the seed time-series, invert the sign of the time-series - if the time-series is going down, in the interaction regressor it will go up.</span><a class="headerlink" href="#id4" title="Link to this image"></a></p>
</figcaption>
</figure>
<figure class="align-default" id="id5">
<img alt="../../_images/11_PPI_Matching.png" src="../../_images/11_PPI_Matching.png" />
<figcaption>
<p><span class="caption-text">The interaction regressor is then compared against the time-series of every other voxel in the brain. If there is a good correspondence between the two, the significance of the fit is higher. Both figures are taken from the <a class="reference external" href="https://fsl.fmrib.ox.ac.uk/fsl/fslwiki/PPI">FSL website</a>.</span><a class="headerlink" href="#id5" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="generalized-ppis">
<h3>Generalized PPIs<a class="headerlink" href="#generalized-ppis" title="Link to this heading"></a></h3>
<p>A more recent version of PPI is known as <strong>generalized PPI (gPPI)</strong> (McLaren et al., 2012). This method creates a PPI term for each condition in the study, in addition to the regressor of the seed time-series and individual regressors for each condition. If the study has N conditions, then the gPPI analysis will contain 2N+1 regressors.</p>
<p>As an example, let’s say that we have three conditions in our experiment: A, B, and C. The gPPI analysis would consist of the following regressors:</p>
<ol class="arabic simple">
<li><p>Regressor for A</p></li>
<li><p>Regressor for B</p></li>
<li><p>Regressor for C</p></li>
<li><p>Time-series regressor for the seed region</p></li>
<li><p>PPI for A</p></li>
<li><p>PPI for B</p></li>
<li><p>PPI for C</p></li>
</ol>
<p>Even if one of these conditions is of no interest, modeling the entire experimental space will be more accurate than restricting the PPI to only a pair of the regressors.</p>
</section>
</section>
<section id="setting-up-a-gppi-in-the-conn-toolbox">
<h2>Setting up a gPPI in the CONN Toolbox<a class="headerlink" href="#setting-up-a-gppi-in-the-conn-toolbox" title="Link to this heading"></a></h2>
<p>So far, we have used the CONN toolbox to model one condition: The resting-state condition, which is simply the time-series at each of our ROIs that we have selected in the Setup tab. We will now load a separate scan that was collected while the subject was doing a task, and which has two conditions: The main task, in which the subject was doing an arithmetic problem, and a control task, in which the subject was doing nothing. The onset times for each of these conditions can be found in the “events.tsv” files on the openneuro webpage for the Arithmetic dataset.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">subjects</span> <span class="o">=</span> <span class="p">[</span><span class="mi">01</span> <span class="mi">02</span> <span class="mi">03</span> <span class="mi">04</span> <span class="mi">05</span> <span class="mi">06</span><span class="p">];</span>

<span class="k">for</span> <span class="n">subject</span><span class="o">=</span><span class="n">subjects</span>

  <span class="n">subject</span><span class="o">=</span><span class="n">num2str</span><span class="p">(</span><span class="n">subject</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%02d</span><span class="s1">&#39;</span><span class="p">);</span>
  <span class="n">movefile</span><span class="p">([</span><span class="s1">&#39;~/Downloads/sub-&#39;</span> <span class="n">num2str</span><span class="p">(</span><span class="n">subject</span><span class="p">)</span> <span class="s1">&#39;_func_sub-&#39;</span> <span class="n">num2str</span><span class="p">(</span><span class="n">subject</span><span class="p">)</span> <span class="s1">&#39;_task-arithm_run-01_bold.nii.gz&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;sub-&#39;</span> <span class="n">num2str</span><span class="p">(</span><span class="n">subject</span><span class="p">)</span> <span class="s1">&#39;/func&#39;</span><span class="p">])</span>
  <span class="n">movefile</span><span class="p">([</span><span class="s1">&#39;~/Downloads/sub-&#39;</span> <span class="n">num2str</span><span class="p">(</span><span class="n">subject</span><span class="p">)</span> <span class="s1">&#39;_func_sub-&#39;</span> <span class="n">num2str</span><span class="p">(</span><span class="n">subject</span><span class="p">)</span> <span class="s1">&#39;_task-arithm_run-02_bold.nii.gz&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;sub-&#39;</span> <span class="n">num2str</span><span class="p">(</span><span class="n">subject</span><span class="p">)</span> <span class="s1">&#39;/func&#39;</span><span class="p">])</span>
  <span class="n">movefile</span><span class="p">([</span><span class="s1">&#39;~/Downloads/sub-&#39;</span> <span class="n">num2str</span><span class="p">(</span><span class="n">subject</span><span class="p">)</span> <span class="s1">&#39;_func_sub-&#39;</span> <span class="n">num2str</span><span class="p">(</span><span class="n">subject</span><span class="p">)</span> <span class="s1">&#39;_task-arithm_run-01_events.tsv&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;sub-&#39;</span> <span class="n">num2str</span><span class="p">(</span><span class="n">subject</span><span class="p">)</span> <span class="s1">&#39;/func&#39;</span><span class="p">])</span>
  <span class="n">movefile</span><span class="p">([</span><span class="s1">&#39;~/Downloads/sub-&#39;</span> <span class="n">num2str</span><span class="p">(</span><span class="n">subject</span><span class="p">)</span> <span class="s1">&#39;_func_sub-&#39;</span> <span class="n">num2str</span><span class="p">(</span><span class="n">subject</span><span class="p">)</span> <span class="s1">&#39;_task-arithm_run-02_events.tsv&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;sub-&#39;</span> <span class="n">num2str</span><span class="p">(</span><span class="n">subject</span><span class="p">)</span> <span class="s1">&#39;/func&#39;</span><span class="p">])</span>

<span class="n">end</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To review onset times, and how they are used to construct a general linear model, see <a class="reference internal" href="../../fMRI_Short_Course/fMRI_05_1stLevelAnalysis.html#fmri-05-1stlevelanalysis"><span class="std std-ref">this module</span></a>.</p>
</div>
<p>We will first demonstrate this with a single subject, and then with a group analysis. Go back to the Setup tab, and click on “Basic”. Set the number of subjects to “1”, and the CONN toolbox will ask which subjects you want to delete. Hold down shift and click to select subjects 2-6, so that only subject 1 remains. Click on the “Functional” button, and select the file <code class="docutils literal notranslate"><span class="pre">sub-01_func_sub-01_task-arithm_run-01_bold.nii.gz</span></code>. This will replace the resting-state scan with a task-related scan.</p>
<p>Then, click on the “Conditions” tab. Clicking on the <code class="docutils literal notranslate"><span class="pre">New</span></code> sign when you hover over the Conditions column will allow you to specify a new regressor. In the “Condition name” field, type <code class="docutils literal notranslate"><span class="pre">control_condition</span></code>, and click on the dropdown menu below “Condition definition” to select “task designs: condition present at blocks/events during selected session(s)”. This will generate two new fields, “Onset” and “Duration”, which you can use to specify when the condition happened, and for how long. Looking at the .tsv file, we see that the onsets were 21.5, 63.5, 105.5, and so on, while the durations were 18.5 for each event. Type the onsets and the durations for each occurrence of the control condition, and then press enter. You can then do the same for the other condition, which we will call <code class="docutils literal notranslate"><span class="pre">main_condition</span></code>.</p>
<p>Doing this once can be a useful exercise, but you most likely will not want to do this for large numbers of subjects. A better alternative is to load the .tsv files through the CONN GUI automatically, which will fill in all of the fields for you. Highlight the conditions you just created and click the <code class="docutils literal notranslate"><span class="pre">x</span></code> sign to remove them, and then click on the <code class="docutils literal notranslate"><span class="pre">-</span> <span class="pre">condition</span> <span class="pre">tools:</span></code> dropdown menu and select <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">condition</span> <span class="pre">info</span> <span class="pre">from</span> <span class="pre">text</span> <span class="pre">file(s)</span></code>. Since this data is in <a class="reference external" href="https://bids.neuroimaging.io/">BIDS format</a>, we can select the option <code class="docutils literal notranslate"><span class="pre">BIDS-compatible</span></code>. (You can select either option for the single subject; when you have more sessions and more subjects, you will want to select the option “one <a href="#id1"><span class="problematic" id="id2">*</span></a>_events.tsv file in each subject/session folder.) When the onset files are loaded, you will see the following figure in the Study Design window:</p>
<figure class="align-default" id="id6">
<img alt="../../_images/11_StudyDesign.png" src="../../_images/11_StudyDesign.png" />
<figcaption>
<p><span class="caption-text">The study design window. Bars indicate the onset and duration of each trial, with separate conditions on each row. Highlighted bars reflect the condition and session that is currently selected in the left-hand menus.</span><a class="headerlink" href="#id6" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>When you are finished importing the timing files, click <code class="docutils literal notranslate"><span class="pre">OK</span></code>. Just as with the functional connectivity analysis, you will need to then run preprocessing, Setup, and Denoising, using similar QA checks.</p>
</section>
<section id="viewing-the-results">
<h2>Viewing the Results<a class="headerlink" href="#viewing-the-results" title="Link to this heading"></a></h2>
<p>After you’ve done preprocessing, Setup, and Denoising, you will have access to the 1st-level tab. The procedure is similar to what we did with the correlation analysis, but we will make the following changes:</p>
<ol class="arabic simple">
<li><p>Click on the <code class="docutils literal notranslate"><span class="pre">new</span></code> button at the bottom of the Analyses panel on the left, and change the analysis type to gPPI (task-based generalized psychophysiological interactions), which will prompt you to select all of your task conditions of interest. Remember that we want to model the entire experimental space; in this case, we will select both and click OK. When it prompts you to “Save these changes to the CONN project?”, select <code class="docutils literal notranslate"><span class="pre">Now</span></code>.</p></li>
</ol>
<figure class="align-default">
<img alt="../../_images/11_SelectConditions.png" src="../../_images/11_SelectConditions.png" />
</figure>
<ol class="arabic simple" start="2">
<li><p>The other change is to switch the analysis options from correlation to regression (bivariate). Notice that once you run the 1st-level analysis, the values in the preview window are not correlation coefficients anymore; they are beta weights for the interaction term. For example, if we have the right Frontal Pole region highlighted and we switch to main_condition, the map shows which voxels are significantly more correlated with the right frontal pole during the main_condition.</p></li>
</ol>
<figure class="align-default">
<img alt="../../_images/11_gPPI_SampleResult.png" src="../../_images/11_gPPI_SampleResult.png" />
</figure>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Before going on, think about this: With the functional connectivity analyses, one of our QA checks was whether the currently highlighted seed region was most significantly correlated with itself, which made sense. Here, if we set the threshold to only show the highest beta weights, there doesn’t seem to be much of anything in that seed region. Given what you just learned about gPPI, why do you think that is?</p>
</div>
<p>For the next step, click on the Done button. This will run a gPPI using all of the seed regions that are in the lefthand menu. If you have an hypothesis about one or two regions, you would only select those, and remove everything else. In this case, let’s just leave in the left and right frontal pole, and then click Done. This will take about a minute to run.</p>
<p>The second-level tab will be the same as what we saw in the video about viewing results. This study wasn’t designed for a gPPI analysis, and PPI effects are notoriously difficult to find in any case; so it isn’t surprising that we don’t see anything here. Nevertheless, if you did find an effect, you would need to follow the same steps of correcting for type 1 errors.</p>
</section>
<section id="generalized-functional-connectivity">
<h2>Generalized Functional Connectivity<a class="headerlink" href="#generalized-functional-connectivity" title="Link to this heading"></a></h2>
<p>Including task regressors also creates the possibility of doing <strong>Generalized Functional Connectivity</strong>, a method of generating resting-state functional connectivity maps from task-based datasets. This method, developed by <a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S1053811919300746">Elliott et al. (2019)</a>, regresses out any effects of task and other nuisance covariates (for example, the usual ones of motion and physiological regressors), and creates functional connectivity maps of the remaining variance. According to Elliott et al., connectivity maps generated this way can lead to test-retest reliability that is comparable to functional data that was collected solely for resting-state, without any task conditions.</p>
<p>Furthermore, this method can theoretically increase your power by allowing you to combine both resting-state runs and data from task-based runs. Taking one resting-state and one task-based dataset from our current example, you should first preprocess them both separately (using the “Session” selector in the Preprocessing window if needed). After preprocessing, click on the <code class="docutils literal notranslate"><span class="pre">Conditions</span></code> button, and load any task regressors for the task-based run. Both runs should contain a regressor called “rest”, as seen below:</p>
<figure class="align-default">
<img alt="../../_images/11_GeneralizedFC_Conditions.png" src="../../_images/11_GeneralizedFC_Conditions.png" />
</figure>
<p>Do the denoising as usual, and then when you get the 1st-level tab and analyze the ROIs you are interested in, you should see something like this, which seems to be an average of the “rest” regressor over both sessions:</p>
<figure class="align-default">
<img alt="../../_images/11_GeneralizedFC_Results.png" src="../../_images/11_GeneralizedFC_Results.png" />
</figure>
<p>The only issue that can come up is if the TRs for the resting-state and task-based data are different; in that case, see <a class="reference external" href="https://www.nitrc.org/forum/message.php?msg_id=15230">this thread</a> for potential ways to address that problem.</p>
</section>
<section id="next-steps">
<h2>Next Steps<a class="headerlink" href="#next-steps" title="Link to this heading"></a></h2>
<p>In this tutorial, we briefly touched on how automating the loading of onset data can save you time. In the next and last tutorial, we will learn how to automate our entire analysis by using something called <strong>scripting</strong>. To find out how to do it, click the <code class="docutils literal notranslate"><span class="pre">Next</span></code> button.</p>
</section>
<section id="video">
<h2>Video<a class="headerlink" href="#video" title="Link to this heading"></a></h2>
<p>A video overview of how to do gPPIs, including loading onset times, can be found <a class="reference external" href="https://www.youtube.com/watch?v=s_lEcGeQOjk&amp;list=PLIQIswOrUH69DoNKYFnOc-UM_tZxwLuMX&amp;index=9">here</a>.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="CONN_10_Viewing_Results.html" class="btn btn-neutral float-left" title="Chapter #10: Viewing the Results" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="CONN_12_Scripting.html" class="btn btn-neutral float-right" title="Chapter #12: Scripting" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Andy Jahn.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>