<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Appendix D: Surface-Based Connectivity &mdash; Andy&#39;s Brain Book 1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b76e3c8a" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=f2a433a1"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Appendix E: Dynamic Connectivity" href="CONN_AppendixE_DynamicConnectivity.html" />
    <link rel="prev" title="Appendix C: Importing ROIs" href="CONN_AppendixC_ImportingROIs.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Andy's Brain Book
          </a>
              <div class="version">
                1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Install</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../installation/fsl_mac_install.html">Overview</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Unix for Neuroimagers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_Intro.html">What is Unix?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_01_Navigation.html">Unix Tutorial #1: 目录操作 (Directories and Navigation)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_02_CopyRemove.html">Unix Tutorial #2: Copying and Removing Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_03_ReadingTextFiles.html">Unix Tutorial #3: Reading Text Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_04_ShellsVariables.html">Unix Tutorial #4: Shells and Path Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_05_ForLoops.html">Unix Tutorial #5: For-Loops</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_06_IfElse.html">Unix Tutorial #6: Conditional Statements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_07_Scripting.html">Unix Tutorial #7: Scripting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_08_Sed.html">Unix Tutorial #8: The Sed Command</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_09_AutomatingTheAnalysis.html">Unix Tutorial #9: Automating The Analysis</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">fMRI Short Course with FSL</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_Intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_01_DataDownload.html">fMRI Tutorial #1: Downloading the Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_02_ExperimentalDesign.html">fMRI Tutorial #2: Overview of The Flanker Task</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_03_LookingAtTheData.html">fMRI Tutorial #3: Looking at the Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_04_Preprocessing.html">fMRI Tutorial #4: Preprocessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_05_1stLevelAnalysis.html">fMRI Tutorial #5: Statistics and Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_06_Scripting.html">fMRI Tutorial #6: Scripting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_07_2ndLevelAnalysis.html">fMRI Tutorial #7: 2nd-Level Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_08_3rdLevelAnalysis.html">fMRI Tutorial #8: 3rd-Level Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_09_ROIAnalysis.html">fMRI Tutorial #9: ROI Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_10_Summary.html">fMRI Tutorial #10: Summary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_Appendices.html">fMRI Short Course: Appendices</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">FreeSurfer</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../FreeSurfer/FreeSurfer_Introduction.html">FreeSurfer Short Course</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">E-Prime</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../E-Prime/E-Prime_Overview.html">Overview of E-Prime</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">AFNI</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../AFNI/AFNI_Overview.html">AFNI Overview</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">SPM</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../SPM/SPM_Overview.html">SPM Overview</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Functional Connectivity with the CONN Toolbox</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../CONN_Overview.html">Functional Connectivity and the CONN Toolbox</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../CONN_Overview.html#overview">Overview</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../CONN_Overview.html#recommended-tutorials">Recommended Tutorials</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="CONN_00_History.html">History of Functional Connectivity</a></li>
<li class="toctree-l3"><a class="reference internal" href="CONN_01_FSL_Demo.html">Chapter #1: Functional Connectivity Demonstration</a></li>
<li class="toctree-l3"><a class="reference internal" href="CONN_02_DataDownload.html">Chapter #2: Downloading the Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="CONN_03_LookingAtData.html">Chapter #3: Downloading the CONN Toolbox</a></li>
<li class="toctree-l3"><a class="reference internal" href="CONN_04_GUI_Overview.html">Chapter #4: The CONN GUI</a></li>
<li class="toctree-l3"><a class="reference internal" href="CONN_05_Preprocessing.html">Chapter #5: Preprocessing</a></li>
<li class="toctree-l3"><a class="reference internal" href="CONN_06_QA_Checks.html">Chapter #6: Quality Assurance Checks</a></li>
<li class="toctree-l3"><a class="reference internal" href="CONN_07_Denoising.html">Chapter #7: Denoising</a></li>
<li class="toctree-l3"><a class="reference internal" href="CONN_08_1stLevel_Analysis.html">Chapter #8: 1st-Level Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="CONN_09_2ndLevel_Analysis.html">Chapter #9: Group-level analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="CONN_10_Viewing_Results.html">Chapter #10: Viewing the Results</a></li>
<li class="toctree-l3"><a class="reference internal" href="CONN_11_Task_gPPI.html">Chapter #11: Task-Related Connectivity and gPPI</a></li>
<li class="toctree-l3"><a class="reference internal" href="CONN_12_Scripting.html">Chapter #12: Scripting</a></li>
<li class="toctree-l3"><a class="reference internal" href="CONN_AppendixA_GraphTheory.html">Appendix A: Graph Theory</a></li>
<li class="toctree-l3"><a class="reference internal" href="CONN_AppendixB_OtherSecondLevelDesigns.html">Appendix B: Other Second-Level Analyses</a></li>
<li class="toctree-l3"><a class="reference internal" href="CONN_AppendixC_ImportingROIs.html">Appendix C: Importing ROIs</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Appendix D: Surface-Based Connectivity</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#creating-the-surface">Creating the Surface</a></li>
<li class="toctree-l4"><a class="reference internal" href="#loading-the-surface-data-into-conn">Loading the Surface Data into CONN</a></li>
<li class="toctree-l4"><a class="reference internal" href="#loading-the-freesurfer-rois">Loading the FreeSurfer ROIs</a></li>
<li class="toctree-l4"><a class="reference internal" href="#running-the-preprocessing">Running the Preprocessing</a></li>
<li class="toctree-l4"><a class="reference internal" href="#denoising">Denoising</a></li>
<li class="toctree-l4"><a class="reference internal" href="#first-level-analysis">First-Level Analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="#second-level-analysis">Second-Level Analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="#video">Video</a></li>
<li class="toctree-l4"><a class="reference internal" href="#next-steps">Next Steps</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="CONN_AppendixE_DynamicConnectivity.html">Appendix E: Dynamic Connectivity</a></li>
<li class="toctree-l3"><a class="reference internal" href="CONN_AppendixF_OpenScienceConnToolbox.html">Appendix F: Open Science and the CONN Toolbox</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Parametric Modulation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../PM/PM_Overview.html">Parametric Modulation in SPM, FSL, and AFNI</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Image Visualization with MRIcroGL</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../MRIcroGL/MRIcroGL_Overview.html">Image Visualization with MRIcroGL</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Introduction to the Human Connectome Project (HCP)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../HCP/HCP_Overview.html">Introduction to the Human Connectome Project</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Finite Impulse Response (FIR) Models</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../FIR/FIR_Overview.html">Finite Impulse Response (FIR)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">fMRI Concepts</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Practicals/DesignOptimization.html">Design Optimization</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Diffusion Analysis with MRtrix</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../MRtrix/MRtrix_Introduction.html">Introduction to MRtrix</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ASL Analysis</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../ASL/ASL_Techniques.html">fASL Tutorial #1: Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ASL/fASL_02_Download.html">fASL Tutorial #2: Downloading and Installing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ASL/fASL_03_Task.html">fASL Tutorial #3: The N-Back Task</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ASL/04_fASL_GUI.html">fASL Tutorial #4: The GUI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ASL/05_fASL_Results.html">fASL Tutorial #5: Examining the Results</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ASL/06_fASL_Quantification.html">fASL Tutorial #6: Quantification</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Frequently Asked Questions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../FrequentlyAskedQuestions/FrequentlyAskedQuestions.html">Frequently Asked Questions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Statistics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Statistics/GIMME.html">GIMME (Group Iterative Multiple Model Estimation)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Open Science</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../OpenScience/OS_Overview.html">Open Science</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced Normalization Tools (ANTs)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../ANTs/ANTs_Overview.html">Advanced Normalization Tools (ANTs)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tract-Based Spatial Statistics (TBSS)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../TBSS/TBSS_Overview.html">Introduction to Tract-Based Spatial Statistics (TBSS)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Statistics for Neuroimagers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Stats/Stats_Overview.html">Statistics for Neuroimagers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Machine Learning for Neuroimagers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../ML/ML_Overview.html">Machine Learning for Neuroimagers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Slicer</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Slicer/Slicer_Overview.html">Slicer Overview</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">CAT12</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../CAT12/CAT12_Overview.html">Voxel-Based Morphometry with CAT12</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Using the Supercomputer</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Supercomputer/Supercomputer_Overview.html">Introduction to Supercomputing</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Matlab for Neuroimagers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Matlab/Matlab_Overview.html">Matlab for Neuroimagers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ITK-Snap</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../ITK-Snap/ITK-Snap_Overview.html">ITK-Snap_Overview</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Python for Neuroimagers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../PythonForNeuroimagers/PythonForNeuroimagers_Overview.html">Python for Neuroimagers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Meta-Analysis for fMRI</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../MetaAnalysis/MetaAnalysis_Overview.html">Meta-Analysis for Neuroimagers</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Andy's Brain Book</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../CONN_Overview.html">Functional Connectivity and the CONN Toolbox</a></li>
      <li class="breadcrumb-item active">Appendix D: Surface-Based Connectivity</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/FunctionalConnectivity/CONN_ShortCourse/CONN_AppendixD_SurfaceBasedConnectivity.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="appendix-d-surface-based-connectivity">
<span id="conn-appendixd-surfacebasedconnectivity"></span><h1>Appendix D: Surface-Based Connectivity<a class="headerlink" href="#appendix-d-surface-based-connectivity" title="Link to this heading"></a></h1>
<hr class="docutils" />
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading"></a></h2>
<p>The analyses you did in the previous chapters were done in what is called <strong>volumetric space</strong>; each image has individual voxels acquired with a specific length, width, and height, and the time-series is averaged across groups of voxels within each region. This works well for most purposes; however, functional connectivity can suffer from the same problems as task-based analysis during the preprocessing step of <span class="xref std std-ref">smoothing</span>. As pointed out in a recent paper by <a class="reference external" href="https://www.nature.com/articles/s41598-020-62832-z#Sec2">Brodoehl et al. (2020)</a>, smoothing can average signal across functionally heterogeneous areas, which can be especially problematic for connectivity analyses. For example, the ridges of two nearby gyri can be a few millimeters away from each other when viewed from above, even though the actual distance from peak to peak - traveling along the ridge of the gyrus, like going down from one hill into a valley, and up the other hill - can be many times longer than that.</p>
<figure class="align-default" id="id1">
<img alt="../../_images/AppendixD_Brodoehl_Figure1.png" src="../../_images/AppendixD_Brodoehl_Figure1.png" />
<figcaption>
<p><span class="caption-text">Figure 1 from Brodoehl et al. (2020). Note that the Euclidean distance (i.e., “as the bird flies”) between adjacent ridges of cortex can be as close as four millimeters. The actual distance from ridge to ridge, traveling through the valleys of the cortex, is ten times as long.</span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>This distance is more accurately represented by reconstructing the image into <strong>surface space</strong>. Simply put, performing task-based and functional connectivity analyses on the surface allows the use of larger smoothing kernels without the signal contamination problems of smoothing in volumetric space. This can both increase power and reduce the chance of smoothing across regions or different tissue types. (More details about the differences between volumetric and surface-based analysis have been detailed in the <a class="reference internal" href="../../AFNI/AFNI_Short_Course/AFNI_09_SurfaceAnalysis.html#afni-09-surfaceanalysis"><span class="std std-ref">SUMA module</span></a>.) For the rest of the chapter, you will need to be familiar with FreeSurfer; the walkthrough can be found <a class="reference internal" href="../../FreeSurfer/FreeSurfer_Introduction.html#freesurfer-introduction"><span class="std std-ref">here</span></a>. Once you have finished that tutorial and learned how to use the <code class="docutils literal notranslate"><span class="pre">recon-all</span></code> command, follow the steps below to modify your CONN project to analyze surface data.</p>
</section>
<section id="creating-the-surface">
<h2>Creating the Surface<a class="headerlink" href="#creating-the-surface" title="Link to this heading"></a></h2>
<p>For the remainder of this tutorial, we will use the first three subjects of the Arithmetic task on OpenNeuro.org, which can be found <a class="reference external" href="https://openneuro.org/datasets/ds002422/versions/1.1.0">here</a>. If you followed the steps in the previous chapters, you should have the entire dataset downloaded. Navigate to the folder <code class="docutils literal notranslate"><span class="pre">Arithmetic</span></code>, and type the following code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>for i in sub-01 sub-02 sub-03; do
  cd $i/anat;
  SUBJECTS_DIR=`pwd`;
  recon-all -s $i -i ${I}_T1w.nii -all;
  cd ../..;
done
</pre></div>
</div>
<p>This will run recon-all sequentially in each <code class="docutils literal notranslate"><span class="pre">anat</span></code> directory. Alternatively, if you have multiple processors on your computer, you could open three separate terminals and run recon-all in each of them; or, you could use the <a class="reference internal" href="../../FreeSurfer/FS_ShortCourse/FS_04_ReconAllParallel.html#fs-04-reconallparallel"><span class="std std-ref">parallel command</span></a>. The latter two options will complete recon-all more quickly by processing each subject in parallel. In any case, you should be able to process all three subjects in about a day.</p>
</section>
<section id="loading-the-surface-data-into-conn">
<h2>Loading the Surface Data into CONN<a class="headerlink" href="#loading-the-surface-data-into-conn" title="Link to this heading"></a></h2>
<p>When <code class="docutils literal notranslate"><span class="pre">recon-all</span></code> finishes, you will have a new directory within each subject’s <code class="docutils literal notranslate"><span class="pre">anat</span></code> folder. Each of these FreeSurfer directories will contain subfolders such as <code class="docutils literal notranslate"><span class="pre">mri</span></code> and <code class="docutils literal notranslate"><span class="pre">surf</span></code>, which you will need to import the surface data into CONN.</p>
<p>First, open a Matlab terminal and open the CONN toolbox. Create a new project called <code class="docutils literal notranslate"><span class="pre">Arithmetic_Surface</span></code>, which will open the Setup Tab. Enter <code class="docutils literal notranslate"><span class="pre">3</span></code> for the number of subjects, and change the TR to <code class="docutils literal notranslate"><span class="pre">3.56</span></code>.</p>
<p>Next, click on the <code class="docutils literal notranslate"><span class="pre">Structural</span></code> button. Within the FreeSurfer output directories, there is a file called <code class="docutils literal notranslate"><span class="pre">T1.mgz</span></code> in the <code class="docutils literal notranslate"><span class="pre">mri</span></code> subfolder. In the <code class="docutils literal notranslate"><span class="pre">Find</span></code> field, type <code class="docutils literal notranslate"><span class="pre">T1.mgz</span></code> and then press the <code class="docutils literal notranslate"><span class="pre">Find</span></code> button; you should see a new list of files that contain the string <code class="docutils literal notranslate"><span class="pre">T1.mgz</span></code>. Shift and click to highlight all of the Subjects in the <code class="docutils literal notranslate"><span class="pre">Structural</span> <span class="pre">data</span></code> field, and then hold control and left-click to select the corresponding T1.mgz files for each subject, and click <code class="docutils literal notranslate"><span class="pre">Import</span></code>. This will automatically detect the surface reconstructed anatomical file, along with any segmentation files. If the aseg.mgz files are loaded, you can skip the segmentation step during preprocessing (discussed in more detail below).</p>
<figure class="align-default">
<img alt="../../_images/AppendixD_LoadStructurals.png" src="../../_images/AppendixD_LoadStructurals.png" />
</figure>
<p>The functional data, by contrast, is still in volumetric space; during preprocessing, it will be resampled to surface space. Click on <code class="docutils literal notranslate"><span class="pre">Functional</span></code>. Similar to what we just did above, enter <code class="docutils literal notranslate"><span class="pre">task-rest_bold.nii.gz</span></code> in the <code class="docutils literal notranslate"><span class="pre">Find</span></code> field; highlight the three subjects in the <code class="docutils literal notranslate"><span class="pre">Functional</span> <span class="pre">data</span></code> window and then control and click to select their corresponding functional files.</p>
<figure class="align-default">
<img alt="../../_images/AppendixD_LoadFunctionals.png" src="../../_images/AppendixD_LoadFunctionals.png" />
</figure>
</section>
<section id="loading-the-freesurfer-rois">
<h2>Loading the FreeSurfer ROIs<a class="headerlink" href="#loading-the-freesurfer-rois" title="Link to this heading"></a></h2>
<p>Even though the CONN toolbox doesn’t have a FreeSurfer atlas that comes with it, you can create it through the Setup tab. Click on the <code class="docutils literal notranslate"><span class="pre">ROIs</span></code> button, and then hover your cursor over the ROIs window and click the <code class="docutils literal notranslate"><span class="pre">new</span></code> button at the bottom of the window. Call the new ROI <code class="docutils literal notranslate"><span class="pre">FS_Atlas</span></code>, and in the “Find” field type <code class="docutils literal notranslate"><span class="pre">lh.aparc.annot</span></code>. (It doesn’t matter whether you use the left hemisphere or right hemisphere; the ROIs for both will be loaded automatically.) Select the file <code class="docutils literal notranslate"><span class="pre">sub-01/anat/fsaverage/label/lh.aparc.annot</span></code>, and then click <code class="docutils literal notranslate"><span class="pre">Import</span></code>. When it is finished importing, make sure the box <code class="docutils literal notranslate"><span class="pre">Atlas</span> <span class="pre">File</span></code> is checked at the bottom of the window.</p>
<figure class="align-default">
<img alt="../../_images/AppendixD_LoadROIs.png" src="../../_images/AppendixD_LoadROIs.png" />
</figure>
</section>
<section id="running-the-preprocessing">
<h2>Running the Preprocessing<a class="headerlink" href="#running-the-preprocessing" title="Link to this heading"></a></h2>
<p>Before you preprocess the images, first click <code class="docutils literal notranslate"><span class="pre">Options</span></code> and change the <code class="docutils literal notranslate"><span class="pre">Analysis</span> <span class="pre">space</span> <span class="pre">(voxel-level)</span></code> to <code class="docutils literal notranslate"><span class="pre">Surface:</span> <span class="pre">same</span> <span class="pre">as</span> <span class="pre">template</span> <span class="pre">(Freesurfer</span> <span class="pre">fsaverage)</span></code>. This will carry out all of the first- and second-level analyses on the FreeSurfer fsaverage template, which is in MNI space. I would also uncheck the <code class="docutils literal notranslate"><span class="pre">Voxel-to-Voxel</span></code> button, to save time; you can perform this analysis later if you want.</p>
<p>Next, click the <code class="docutils literal notranslate"><span class="pre">Preprocessing</span></code> button, and select <code class="docutils literal notranslate"><span class="pre">preprocessing</span> <span class="pre">pipeline</span> <span class="pre">for</span> <span class="pre">surface-based</span> <span class="pre">analyses</span> <span class="pre">(in</span> <span class="pre">subject-space)</span></code>. If you have the time and the processing power, you can choose the nonlinear coregistration option, which takes longer but generates a more accurate resampling of the volumetric data to surface space. In this example, I will remove slice-timing correction (since I don’t know how the slices were acquired in this experiment), and also segmentation, since the anatomical images were already segmented by FreeSurfer, and the segmentations were imported.</p>
<p>When the preprocessing finishes, go back to the <code class="docutils literal notranslate"><span class="pre">ROIs</span></code> section, and click on <code class="docutils literal notranslate"><span class="pre">FS_Atlas</span></code>. Under <code class="docutils literal notranslate"><span class="pre">Compute</span> <span class="pre">average</span> <span class="pre">timeseries</span></code>, select <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">secondary</span> <span class="pre">dataset</span> <span class="pre">#4</span> <span class="pre">(surface-space</span> <span class="pre">data)</span></code>. This will use the averaged time-series from the resampled grey matter on the surface, instead of the volumetric data. When you have finished all of this, click the <code class="docutils literal notranslate"><span class="pre">Done</span></code> button to run the Setup pipeline.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Once preprocessing has finished, you can see the functional connectivity maps on the individual subject surfaces by clicking on the <code class="docutils literal notranslate"><span class="pre">Functional</span></code> button. Similar to volumetric analysis, you will see the first volume on the left-hand side, and the last volume of the time-series on the right-hand side.</p>
</div>
</section>
<section id="denoising">
<h2>Denoising<a class="headerlink" href="#denoising" title="Link to this heading"></a></h2>
<p>The Denoising tab will be the same as was during the volumetric functional connectivity analysis, and the interpretation of the connectivity distributions and principal components correction is the same. The only difference is that you will see the BOLD variance projected onto a surface for each subject, instead of their volume.</p>
<figure class="align-default">
<img alt="../../_images/AppendixD_Denoising.png" src="../../_images/AppendixD_Denoising.png" />
</figure>
</section>
<section id="first-level-analysis">
<h2>First-Level Analysis<a class="headerlink" href="#first-level-analysis" title="Link to this heading"></a></h2>
<p>The First-Level Analysis tab will also be very similar to a volumetric analysis, except that this time the results are projected onto a cortical surface. To save time, we will remove all of the <code class="docutils literal notranslate"><span class="pre">Selected</span> <span class="pre">Seeds/Sources</span></code> except for the first three ROIs listed in the <code class="docutils literal notranslate"><span class="pre">FS_Atlas</span></code> that we specified in the <code class="docutils literal notranslate"><span class="pre">Setup</span></code> tab: the <code class="docutils literal notranslate"><span class="pre">FS_Atlas.bankssts</span> <span class="pre">(L)</span></code>, <code class="docutils literal notranslate"><span class="pre">FS_Atlas.caudalanteriorcingulate</span> <span class="pre">(L)</span></code>, and <code class="docutils literal notranslate"><span class="pre">FS_Atlas.caudalmiddlefrontal</span> <span class="pre">(L)</span></code>. Keep all the other defaults the same, then click the <code class="docutils literal notranslate"><span class="pre">Done</span></code> button; once it is finished, you can return to this tab and see connectivity maps for each ROI that was specified.</p>
<figure class="align-default">
<img alt="../../_images/AppendixD_1stLevel.png" src="../../_images/AppendixD_1stLevel.png" />
</figure>
</section>
<section id="second-level-analysis">
<h2>Second-Level Analysis<a class="headerlink" href="#second-level-analysis" title="Link to this heading"></a></h2>
<p>Once the first-level results are done, you can highlight any of the regions and click the <code class="docutils literal notranslate"><span class="pre">compute</span> <span class="pre">results</span></code> button. This will display a group-level result in the <code class="docutils literal notranslate"><span class="pre">2nd-level</span></code> tab, and also generate a window with a glass brain and a corresponding table of significant clusters. If you click on the <code class="docutils literal notranslate"><span class="pre">Surface</span> <span class="pre">Display</span></code> button (the first one in the upper-left corner of the buttons under <code class="docutils literal notranslate"><span class="pre">Display&amp;Print</span></code>, you can more accurately see the connectivity results displayed on the surface of the cortex.</p>
<figure class="align-default">
<img alt="../../_images/AppendixD_GroupResults.png" src="../../_images/AppendixD_GroupResults.png" />
</figure>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As of the current version used in these tutorials (21.a), it does not appear that both subcortical and surface-based cortical parcellations can be combined in the same analysis; see <a class="reference external" href="https://www.nitrc.org/forum/message.php?msg_id=10281">this thread</a> for more details.</p>
</div>
</section>
<section id="video">
<h2>Video<a class="headerlink" href="#video" title="Link to this heading"></a></h2>
<p>For a video demonstration of how to do a surface-based analysis in the CONN toolbox, click <a class="reference external" href="https://youtu.be/M8njs_NwtwI">here</a>.</p>
</section>
<section id="next-steps">
<h2>Next Steps<a class="headerlink" href="#next-steps" title="Link to this heading"></a></h2>
<p>All of the other options for volumetric-based analysis, including independent-samples tests, adding covariates, and ROI-to-ROI analyses, are the same in this case as well; the only difference being that the results are displayed on the surface. See the previous chapters for a walkthrough on how to run these other analyses.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="CONN_AppendixC_ImportingROIs.html" class="btn btn-neutral float-left" title="Appendix C: Importing ROIs" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="CONN_AppendixE_DynamicConnectivity.html" class="btn btn-neutral float-right" title="Appendix E: Dynamic Connectivity" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Andy Jahn.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>