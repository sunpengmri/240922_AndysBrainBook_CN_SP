<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>FreeSurfer Tutorial #5: Using the Open Science Grid &mdash; Andy&#39;s Brain Book 1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b76e3c8a" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=f2a433a1"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="FreeSurfer Tutorial #6: Freeview" href="FS_06_Freeview.html" />
    <link rel="prev" title="FreeSurfer Tutorial #4: Running recon-all in Parallel" href="FS_04_ReconAllParallel.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Andy's Brain Book
          </a>
              <div class="version">
                1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Install</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../installation/fsl_mac_install.html">Overview</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Unix for Neuroimagers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_Intro.html">What is Unix?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_01_Navigation.html">Unix Tutorial #1: 目录操作 (Directories and Navigation)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_02_CopyRemove.html">Unix Tutorial #2: Copying and Removing Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_03_ReadingTextFiles.html">Unix Tutorial #3: Reading Text Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_04_ShellsVariables.html">Unix Tutorial #4: Shells and Path Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_05_ForLoops.html">Unix Tutorial #5: For-Loops</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_06_IfElse.html">Unix Tutorial #6: Conditional Statements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_07_Scripting.html">Unix Tutorial #7: Scripting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_08_Sed.html">Unix Tutorial #8: The Sed Command</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_09_AutomatingTheAnalysis.html">Unix Tutorial #9: Automating The Analysis</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">fMRI Short Course with FSL</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_Intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_01_DataDownload.html">fMRI Tutorial #1: Downloading the Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_02_ExperimentalDesign.html">fMRI Tutorial #2: Overview of The Flanker Task</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_03_LookingAtTheData.html">fMRI Tutorial #3: Looking at the Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_04_Preprocessing.html">fMRI Tutorial #4: Preprocessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_05_1stLevelAnalysis.html">fMRI Tutorial #5: Statistics and Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_06_Scripting.html">fMRI Tutorial #6: Scripting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_07_2ndLevelAnalysis.html">fMRI Tutorial #7: 2nd-Level Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_08_3rdLevelAnalysis.html">fMRI Tutorial #8: 3rd-Level Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_09_ROIAnalysis.html">fMRI Tutorial #9: ROI Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_10_Summary.html">fMRI Tutorial #10: Summary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_Appendices.html">fMRI Short Course: Appendices</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">FreeSurfer</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../FreeSurfer_Introduction.html">FreeSurfer Short Course</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../FreeSurfer_Introduction.html#overview">Overview</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="FS_01_BasicTerms.html">FreeSurfer Tutorial #1: Basic Terms</a></li>
<li class="toctree-l3"><a class="reference internal" href="FS_02_DownloadInstall.html">FreeSurfer Tutorial #2: How to Download and Install</a></li>
<li class="toctree-l3"><a class="reference internal" href="FS_03_ReconAll.html">FreeSurfer Tutorial #3: Recon-all</a></li>
<li class="toctree-l3"><a class="reference internal" href="FS_04_ReconAllParallel.html">FreeSurfer Tutorial #4: Running recon-all in Parallel</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">FreeSurfer Tutorial #5: Using the Open Science Grid</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#time-constraints-with-recon-all">Time Constraints with Recon-All</a></li>
<li class="toctree-l4"><a class="reference internal" href="#preparing-your-data-for-the-open-science-grid">Preparing Your Data for the Open Science Grid</a></li>
<li class="toctree-l4"><a class="reference internal" href="#submitting-recon-all-jobs">Submitting Recon-All Jobs</a></li>
<li class="toctree-l4"><a class="reference internal" href="#downloading-or-removing-jobs">Downloading or Removing Jobs</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="FS_06_Freeview.html">FreeSurfer Tutorial #6: Freeview</a></li>
<li class="toctree-l3"><a class="reference internal" href="FS_07_FSGD.html">FreeSurfer Tutorial #7: The FSGD File</a></li>
<li class="toctree-l3"><a class="reference internal" href="FS_08_GroupAnalysis.html">FreeSurfer Tutorial #8: Group Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="FS_09_ClusterCorrection.html">FreeSurfer Tutorial #9: Cluster Correction</a></li>
<li class="toctree-l3"><a class="reference internal" href="FS_10_CorrelationAnalysis.html">FreeSurfer Tutorial #10: Correlation Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="FS_11_ROIAnalysis.html">FreeSurfer Tutorial #11: Region of Interest Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="FS_12_FailureModes.html">FreeSurfer Tutorial #12: Introduction to Failure Modes</a></li>
<li class="toctree-l3"><a class="reference internal" href="FS_13_PialSurface.html">FreeSurfer Tutorial #13: SkullStripping and Pial Surface Errors</a></li>
<li class="toctree-l3"><a class="reference internal" href="FS_14_ControlPoints.html">FreeSurfer Tutorial #14: Control Points and Intensity Normalization</a></li>
<li class="toctree-l3"><a class="reference internal" href="AppendixA_LGI.html">Appendix A: Local Gyrification Index</a></li>
<li class="toctree-l3"><a class="reference internal" href="AppendixB_PETSurfer.html">Appendix B: PETSurfer</a></li>
<li class="toctree-l3"><a class="reference internal" href="AppendixC_Annotations.html">Appendix C: Annotating Anatomical Images with Freeview</a></li>
<li class="toctree-l3"><a class="reference internal" href="AppendixD_SegmentingSubfields.html">Appendix D: Segmenting Hippocampal, Amygdala, Brainstem, and Thalamus Subfields</a></li>
<li class="toctree-l3"><a class="reference internal" href="../TRACULA_ShortCourse/TRACULA_01_Intro.html">TRACULA Tutorial #1: Overview</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">E-Prime</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../E-Prime/E-Prime_Overview.html">Overview of E-Prime</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">AFNI</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../AFNI/AFNI_Overview.html">AFNI Overview</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">SPM</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../SPM/SPM_Overview.html">SPM Overview</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Functional Connectivity with the CONN Toolbox</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../FunctionalConnectivity/CONN_Overview.html">Functional Connectivity and the CONN Toolbox</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Parametric Modulation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../PM/PM_Overview.html">Parametric Modulation in SPM, FSL, and AFNI</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Image Visualization with MRIcroGL</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../MRIcroGL/MRIcroGL_Overview.html">Image Visualization with MRIcroGL</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Introduction to the Human Connectome Project (HCP)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../HCP/HCP_Overview.html">Introduction to the Human Connectome Project</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Finite Impulse Response (FIR) Models</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../FIR/FIR_Overview.html">Finite Impulse Response (FIR)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">fMRI Concepts</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Practicals/DesignOptimization.html">Design Optimization</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Diffusion Analysis with MRtrix</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../MRtrix/MRtrix_Introduction.html">Introduction to MRtrix</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ASL Analysis</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../ASL/ASL_Techniques.html">fASL Tutorial #1: Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ASL/fASL_02_Download.html">fASL Tutorial #2: Downloading and Installing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ASL/fASL_03_Task.html">fASL Tutorial #3: The N-Back Task</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ASL/04_fASL_GUI.html">fASL Tutorial #4: The GUI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ASL/05_fASL_Results.html">fASL Tutorial #5: Examining the Results</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ASL/06_fASL_Quantification.html">fASL Tutorial #6: Quantification</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Frequently Asked Questions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../FrequentlyAskedQuestions/FrequentlyAskedQuestions.html">Frequently Asked Questions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Statistics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Statistics/GIMME.html">GIMME (Group Iterative Multiple Model Estimation)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Open Science</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../OpenScience/OS_Overview.html">Open Science</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced Normalization Tools (ANTs)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../ANTs/ANTs_Overview.html">Advanced Normalization Tools (ANTs)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tract-Based Spatial Statistics (TBSS)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../TBSS/TBSS_Overview.html">Introduction to Tract-Based Spatial Statistics (TBSS)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Statistics for Neuroimagers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Stats/Stats_Overview.html">Statistics for Neuroimagers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Machine Learning for Neuroimagers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../ML/ML_Overview.html">Machine Learning for Neuroimagers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Slicer</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Slicer/Slicer_Overview.html">Slicer Overview</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">CAT12</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../CAT12/CAT12_Overview.html">Voxel-Based Morphometry with CAT12</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Using the Supercomputer</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Supercomputer/Supercomputer_Overview.html">Introduction to Supercomputing</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Matlab for Neuroimagers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Matlab/Matlab_Overview.html">Matlab for Neuroimagers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ITK-Snap</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../ITK-Snap/ITK-Snap_Overview.html">ITK-Snap_Overview</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Python for Neuroimagers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../PythonForNeuroimagers/PythonForNeuroimagers_Overview.html">Python for Neuroimagers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Meta-Analysis for fMRI</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../MetaAnalysis/MetaAnalysis_Overview.html">Meta-Analysis for Neuroimagers</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Andy's Brain Book</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../FreeSurfer_Introduction.html">FreeSurfer Short Course</a></li>
      <li class="breadcrumb-item active">FreeSurfer Tutorial #5: Using the Open Science Grid</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/FreeSurfer/FS_ShortCourse/FS_05_OpenScienceGrid.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="admonition warning" id="fs-05-opensciencegrid">
<p class="admonition-title">Warning</p>
<p>fsurf has been deprecated and is no longer supported; to run Freesurfer jobs on the OSG, you can request an account on the
<a class="reference external" href="https://www.osgconnect.net/">OSG Connnect</a> service (available to all researchers affiliated with a US-based institution or project) and then follow the instructions
on <a class="reference external" href="https://support.opensciencegrid.org/support/solutions/articles/12000008483-introduction-to-freesurfer-on-osg">this page</a> which shows
how to submit your own Freesurfer workload to the OSG.</p>
</div>
<section id="freesurfer-tutorial-5-using-the-open-science-grid">
<h1>FreeSurfer Tutorial #5: Using the Open Science Grid<a class="headerlink" href="#freesurfer-tutorial-5-using-the-open-science-grid" title="Link to this heading"></a></h1>
<hr class="docutils" />
<section id="time-constraints-with-recon-all">
<h2>Time Constraints with Recon-All<a class="headerlink" href="#time-constraints-with-recon-all" title="Link to this heading"></a></h2>
<p>Even if you are able to run multiple jobs with the parallel command, it may not be practical for very large datasets - for example, a study that includes hundreds of subjects. You also may not want to have all of your processing cores tied up in running recon-all, and would prefer to have your computer free to use for other projects.</p>
<p>One option is to use a <strong>supercomputer</strong>, which is available at most universities. If you don’t have access to one, then you can use a publicly available supercomputer hosted by the <a class="reference external" href="https://opensciencegrid.org/">Open Science Grid</a>, which uses processing cores on computers located across over a hundred sites - laboratories, universities, and other institutions. You can submit a recon-all command to the Open Science Grid, which is then distributed to one of the many cores that are available. For most imaging researchers there is essentially no limit on how many jobs you can submit; a batch containing one or two hundred jobs isn’t very large by supercomputer standards, and the entire batch can usually be finished in less than a week.</p>
</section>
<section id="preparing-your-data-for-the-open-science-grid">
<h2>Preparing Your Data for the Open Science Grid<a class="headerlink" href="#preparing-your-data-for-the-open-science-grid" title="Link to this heading"></a></h2>
<p>Before you can use any of the Open Science Grid resources, you must create an account <a class="reference external" href="https://support.opensciencegrid.org/support/solutions/articles/12000008488-set-up-fsurf-on-your-laptop">here</a>.</p>
<p>You will also need a command called <code class="docutils literal notranslate"><span class="pre">fsurf</span></code> to submit recon-all jobs to the Open Science Grid supercomputer. To download this command, type:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">L</span> <span class="o">-</span><span class="n">o</span> <span class="n">fsurf</span> <span class="s1">&#39;http://stash.osgconnect.net/+fsurf/fsurf&#39;</span>
<span class="n">chmod</span> <span class="o">+</span><span class="n">x</span> <span class="n">fsurf</span>
</pre></div>
</div>
<p>And then move the fsurf executible into a directory that your PATH points to. For example, most operating systems have a path that by default points to the <code class="docutils literal notranslate"><span class="pre">/bin</span></code> directory - the same directory that contains commands such as <code class="docutils literal notranslate"><span class="pre">ls</span></code>, <code class="docutils literal notranslate"><span class="pre">cd</span></code>, and <code class="docutils literal notranslate"><span class="pre">pwd</span></code>. If you move <code class="docutils literal notranslate"><span class="pre">fsurf</span></code> to <code class="docutils literal notranslate"><span class="pre">/bin</span></code>, then you can run the command from any directory:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">mv</span> <span class="n">fsurf</span> <span class="o">/</span><span class="nb">bin</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the code example above, <code class="docutils literal notranslate"><span class="pre">sudo</span></code> is used to move fsurf to the /bin directory. That is because the /bin directory is considered sensitive - you don’t want anyone changing it unless they know what they’re doing. Consequently, sudo will prompt you to enter your password before it moves the file.</p>
</div>
<p>Next, create a list of all of the subjects by typing the following code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ls</span> <span class="o">|</span> <span class="n">grep</span> <span class="n">sub</span><span class="o">-</span> <span class="o">&gt;</span> <span class="n">subjList</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<p>This will pipe the results of the <code class="docutils literal notranslate"><span class="pre">ls</span></code> command into a file called subjList.txt. We will then use this list to create a for-loop to submit all of our recon-all jobs to the Open Science Grid supercomputer.</p>
</section>
<section id="submitting-recon-all-jobs">
<h2>Submitting Recon-All Jobs<a class="headerlink" href="#submitting-recon-all-jobs" title="Link to this heading"></a></h2>
<p>The Open Science Grid is particular about how the jobs are submitted; each anatomical image needs to be packaged in a certain way, just as you need to package items when you drop them off at the post office.</p>
<p>First you will need to run recon-all on your anatomical images, omitting the <code class="docutils literal notranslate"><span class="pre">-all</span></code> option. This will create a series of directories, and then convert the anatomical image to .mgz format and place it in the <code class="docutils literal notranslate"><span class="pre">mri/orig</span></code> directory. The following code can be either copied and pasted into the Terminal, or you can copy it into a shell script and run it with <code class="docutils literal notranslate"><span class="pre">tcsh</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>foreach subj (`cat subjList.txt`)
      cd $subj/ses-BL/anat
      if (! -d $subj ) then #If the FS directory doesn&#39;t exist, then run recon-all
              recon-all -s $subj -i *.nii.gz -sd .
              #zip the FreeSurfer directories, so they can be submitted to fsurf
              zip -r $subj.zip $subj
              cd ../../..
      else
              echo &quot;FreeSurfer folder for $subj already exists; if you want to rerun recon-all for this subject, delete the folder and rerun this script.&quot;
              cd ../../..
      endif
  end
</pre></div>
</div>
<p>Once that has finished, you can submit the jobs using <code class="docutils literal notranslate"><span class="pre">fsurf</span></code>. In this example, I’ve placed <code class="docutils literal notranslate"><span class="pre">fsurf</span></code> in a for-loop:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>foreach subj (`cat subjList.txt`)
      cd $subj/ses-BL/anat
      fsurf submit --subject=$subj --input=$subj.zip --defaced --deidentified --version 6.0.0 --freesurfer-options=&#39;-all -qcache -3T&#39;
      cd ../../..
end
</pre></div>
</div>
<p>The status of the jobs can then be checked by typing <code class="docutils literal notranslate"><span class="pre">fsurf</span> <span class="pre">list</span></code>, which will print several columns to the screen. The first column is the subject name, the second column is the subject ID assigned by the Open Science Grid supercomputer, and the second-to-last column specifies whether the job is running, completed, or has failed. Periodically check the status of these jobs to see which ones can be downloaded.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The previous code examples are written in <code class="docutils literal notranslate"><span class="pre">tcsh</span></code> instead of <code class="docutils literal notranslate"><span class="pre">bash</span></code>. You can write it in either one; I just happened to be using <code class="docutils literal notranslate"><span class="pre">tcsh</span></code> at the time.</p>
</div>
</section>
<section id="downloading-or-removing-jobs">
<h2>Downloading or Removing Jobs<a class="headerlink" href="#downloading-or-removing-jobs" title="Link to this heading"></a></h2>
<p>Once recon-all has finished, you can download the output by typing this code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fsurf</span> <span class="n">output</span> <span class="o">--</span><span class="nb">id</span> <span class="o">&lt;</span><span class="n">subjID</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>In which <code class="docutils literal notranslate"><span class="pre">subjID</span></code> is the identifcation code assigned by the supercomputer. It is the number in the second column of the output of the command <code class="docutils literal notranslate"><span class="pre">fsurf</span> <span class="pre">list</span></code>. The downloaded data will have . <code class="docutils literal notranslate"><span class="pre">.bz2</span></code> extension; you can unpack it by typing <code class="docutils literal notranslate"><span class="pre">tar</span> <span class="pre">xvjf</span> <span class="pre">&lt;subjName&gt;</span></code>, replacing <code class="docutils literal notranslate"><span class="pre">subjName</span></code> with the name of the downloaded dataset.</p>
<p>On the other hand, if you want to remove a job at any time for any reason, you can do so by typing:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fsurf</span> <span class="n">remove</span> <span class="o">--</span><span class="nb">id</span> <span class="o">&lt;</span><span class="n">subjID</span><span class="o">&gt;</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">subjID</span></code> is found the same way as above.</p>
<hr class="docutils" />
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="FS_04_ReconAllParallel.html" class="btn btn-neutral float-left" title="FreeSurfer Tutorial #4: Running recon-all in Parallel" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="FS_06_Freeview.html" class="btn btn-neutral float-right" title="FreeSurfer Tutorial #6: Freeview" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Andy Jahn.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>