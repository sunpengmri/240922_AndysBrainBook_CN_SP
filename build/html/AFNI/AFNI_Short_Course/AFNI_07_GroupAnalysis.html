<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AFNI Tutorial #7: Group Analysis &mdash; Andy&#39;s Brain Book 1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b76e3c8a" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=f2a433a1"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="AFNI Tutorial #8: ROI Analysis" href="AFNI_08_ROIAnalysis.html" />
    <link rel="prev" title="AFNI Tutorial #6: Scripting" href="AFNI_06_Scripting.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Andy's Brain Book
          </a>
              <div class="version">
                1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Install</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../installation/fsl_mac_install.html">Overview</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Unix for Neuroimagers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_Intro.html">What is Unix?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_01_Navigation.html">Unix Tutorial #1: 目录操作 (Directories and Navigation)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_02_CopyRemove.html">Unix Tutorial #2: Copying and Removing Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_03_ReadingTextFiles.html">Unix Tutorial #3: Reading Text Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_04_ShellsVariables.html">Unix Tutorial #4: Shells and Path Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_05_ForLoops.html">Unix Tutorial #5: For-Loops</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_06_IfElse.html">Unix Tutorial #6: Conditional Statements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_07_Scripting.html">Unix Tutorial #7: Scripting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_08_Sed.html">Unix Tutorial #8: The Sed Command</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_09_AutomatingTheAnalysis.html">Unix Tutorial #9: Automating The Analysis</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">fMRI Short Course with FSL</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_Intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_01_DataDownload.html">fMRI Tutorial #1: Downloading the Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_02_ExperimentalDesign.html">fMRI Tutorial #2: Overview of The Flanker Task</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_03_LookingAtTheData.html">fMRI Tutorial #3: Looking at the Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_04_Preprocessing.html">fMRI Tutorial #4: Preprocessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_05_1stLevelAnalysis.html">fMRI Tutorial #5: Statistics and Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_06_Scripting.html">fMRI Tutorial #6: Scripting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_07_2ndLevelAnalysis.html">fMRI Tutorial #7: 2nd-Level Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_08_3rdLevelAnalysis.html">fMRI Tutorial #8: 3rd-Level Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_09_ROIAnalysis.html">fMRI Tutorial #9: ROI Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_10_Summary.html">fMRI Tutorial #10: Summary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_Appendices.html">fMRI Short Course: Appendices</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">FreeSurfer</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../FreeSurfer/FreeSurfer_Introduction.html">FreeSurfer Short Course</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">E-Prime</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../E-Prime/E-Prime_Overview.html">Overview of E-Prime</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">AFNI</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../AFNI_Overview.html">AFNI Overview</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../AFNI_Overview.html#what-is-afni">What is AFNI?</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="AFNI_fMRI_Intro.html">Introduction to AFNI</a></li>
<li class="toctree-l3"><a class="reference internal" href="AFNI_01_DataDownload.html">AFNI Tutorial #1: Downloading the Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="AFNI_02_ExperimentalDesign.html">AFNI Tutorial #2: The Flanker Experiment</a></li>
<li class="toctree-l3"><a class="reference internal" href="AFNI_03_LookingAtTheData.html">AFNI Tutorial #3: Looking at the Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="AFNI_04_Preprocessing.html">AFNI Tutorial #4: AFNI Commands and Preprocessing</a></li>
<li class="toctree-l3"><a class="reference internal" href="AFNI_05_1stLevelAnalysis.html">AFNI Tutorial #5: Statistics and Modeling</a></li>
<li class="toctree-l3"><a class="reference internal" href="AFNI_06_Scripting.html">AFNI Tutorial #6: Scripting</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">AFNI Tutorial #7: Group Analysis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#using-uber-ttest-py">Using uber_ttest.py</a></li>
<li class="toctree-l4"><a class="reference internal" href="#generating-the-results">Generating the Results</a></li>
<li class="toctree-l4"><a class="reference internal" href="#non-parametric-tests-with-3dclustsim">Non-Parametric Tests with 3dClustSim</a></li>
<li class="toctree-l4"><a class="reference internal" href="#using-3dmema">Using 3dMEMA</a></li>
<li class="toctree-l4"><a class="reference internal" href="#video">Video</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="AFNI_08_ROIAnalysis.html">AFNI Tutorial #8: ROI Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="AFNI_09_SurfaceAnalysis.html">AFNI Tutorial #9: Surface-Based Analysis with SUMA</a></li>
<li class="toctree-l3"><a class="reference internal" href="AppendixA_ParametricModulation.html">Appendix A: Parametric Modulation in AFNI</a></li>
<li class="toctree-l3"><a class="reference internal" href="AppendixB_AnimalAnalysis.html">Appendix B: Analyzing Rat Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="AppendixC_HighlightingResults.html">Appendix C: Highlighting Vs. Hiding Results</a></li>
<li class="toctree-l3"><a class="reference internal" href="AppendixD_EffectSizes.html">Appendix D: Reporting Effect Sizes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">SPM</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../SPM/SPM_Overview.html">SPM Overview</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Functional Connectivity with the CONN Toolbox</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../FunctionalConnectivity/CONN_Overview.html">Functional Connectivity and the CONN Toolbox</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Parametric Modulation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../PM/PM_Overview.html">Parametric Modulation in SPM, FSL, and AFNI</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Image Visualization with MRIcroGL</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../MRIcroGL/MRIcroGL_Overview.html">Image Visualization with MRIcroGL</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Introduction to the Human Connectome Project (HCP)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../HCP/HCP_Overview.html">Introduction to the Human Connectome Project</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Finite Impulse Response (FIR) Models</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../FIR/FIR_Overview.html">Finite Impulse Response (FIR)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">fMRI Concepts</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Practicals/DesignOptimization.html">Design Optimization</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Diffusion Analysis with MRtrix</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../MRtrix/MRtrix_Introduction.html">Introduction to MRtrix</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ASL Analysis</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../ASL/ASL_Techniques.html">fASL Tutorial #1: Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ASL/fASL_02_Download.html">fASL Tutorial #2: Downloading and Installing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ASL/fASL_03_Task.html">fASL Tutorial #3: The N-Back Task</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ASL/04_fASL_GUI.html">fASL Tutorial #4: The GUI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ASL/05_fASL_Results.html">fASL Tutorial #5: Examining the Results</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ASL/06_fASL_Quantification.html">fASL Tutorial #6: Quantification</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Frequently Asked Questions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../FrequentlyAskedQuestions/FrequentlyAskedQuestions.html">Frequently Asked Questions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Statistics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Statistics/GIMME.html">GIMME (Group Iterative Multiple Model Estimation)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Open Science</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../OpenScience/OS_Overview.html">Open Science</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced Normalization Tools (ANTs)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../ANTs/ANTs_Overview.html">Advanced Normalization Tools (ANTs)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tract-Based Spatial Statistics (TBSS)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../TBSS/TBSS_Overview.html">Introduction to Tract-Based Spatial Statistics (TBSS)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Statistics for Neuroimagers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Stats/Stats_Overview.html">Statistics for Neuroimagers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Machine Learning for Neuroimagers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../ML/ML_Overview.html">Machine Learning for Neuroimagers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Slicer</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Slicer/Slicer_Overview.html">Slicer Overview</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">CAT12</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../CAT12/CAT12_Overview.html">Voxel-Based Morphometry with CAT12</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Using the Supercomputer</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Supercomputer/Supercomputer_Overview.html">Introduction to Supercomputing</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Matlab for Neuroimagers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Matlab/Matlab_Overview.html">Matlab for Neuroimagers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ITK-Snap</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../ITK-Snap/ITK-Snap_Overview.html">ITK-Snap_Overview</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Python for Neuroimagers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../PythonForNeuroimagers/PythonForNeuroimagers_Overview.html">Python for Neuroimagers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Meta-Analysis for fMRI</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../MetaAnalysis/MetaAnalysis_Overview.html">Meta-Analysis for Neuroimagers</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Andy's Brain Book</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../AFNI_Overview.html">AFNI Overview</a></li>
      <li class="breadcrumb-item active">AFNI Tutorial #7: Group Analysis</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/AFNI/AFNI_Short_Course/AFNI_07_GroupAnalysis.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="afni-tutorial-7-group-analysis">
<span id="afni-07-groupanalysis"></span><h1>AFNI Tutorial #7: Group Analysis<a class="headerlink" href="#afni-tutorial-7-group-analysis" title="Link to this heading"></a></h1>
<hr class="docutils" />
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading"></a></h2>
<p>Our goal in analyzing this dataset is to generalize the results to the population that the sample was drawn from. In other words, if we see changes in brain activity in our sample, can we say that these changes would likely be seen in the population as well?</p>
<p>To test this, we will run a <strong>group-level analysis</strong> (also known as a <strong>second-level analysis</strong>). In AFNI, this means that we calculate the standard error and the mean for a contrast estimate, and then test whether the average estimate is statistically significant. We will be doing this group-level analysis in two ways: Using 3dttest, which uses only the contrast estimates in testing for statistical significance; and using 3dMEMA, which accounts for both the difference between the parameter estimates, and the variability of that contrast.</p>
</section>
<section id="using-uber-ttest-py">
<h2>Using uber_ttest.py<a class="headerlink" href="#using-uber-ttest-py" title="Link to this heading"></a></h2>
<p>Just as we used a <a class="reference internal" href="AFNI_Preprocessing/01_AFNI_Commands_uber_subject.html#afni-commands-uber-subject"><span class="std std-ref">graphical user interface to preprocess the data</span></a>, we can also use a GUI to set up our group-level analyses. If you type the command <code class="docutils literal notranslate"><span class="pre">uber_ttest.py</span></code> from the command line and press return, you will see this:</p>
<figure class="align-default">
<img alt="../../_images/07_uber_ttest_GUI.png" src="../../_images/07_uber_ttest_GUI.png" />
</figure>
<p>The first field, “program”, allows you to choose between <code class="docutils literal notranslate"><span class="pre">3dttest</span></code> and <code class="docutils literal notranslate"><span class="pre">3dMEMA</span></code>. As noted above, 3dMEMA allows you to account for the variability of the estimate as well, in order to give more weight to those subjects who have lower variability in their estimates. For now, leave it as “3dttest”.</p>
<p>In both the “script name” and “dset prefix” fields, enter <code class="docutils literal notranslate"><span class="pre">Flanker_Inc-Con_ttest</span></code>. For the “mask dset”, you can choose any one of the subject’s <code class="docutils literal notranslate"><span class="pre">mask_group+tlrc</span></code> images located in their results directories, as they should be similar. If you want to be more rigorous, you can calculate an intersection of the masks using AFNI’s <code class="docutils literal notranslate"><span class="pre">3dmask_tool</span></code> command. The command would look something like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">3</span><span class="n">dmask_tool</span> <span class="o">-</span><span class="nb">input</span> <span class="o">&lt;</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">masks</span><span class="o">/&gt;</span> <span class="o">-</span><span class="n">prefix</span> <span class="n">mask_intersection</span><span class="o">+</span><span class="n">tlrc</span> <span class="o">-</span><span class="n">union</span>
</pre></div>
</div>
<p>We will now select each of the subject statistical datasets, using wildcards. If you click on the button “get subj dsets” in the “datasets A” section, you will be prompted to select a representative stats dataset. Select any of the subjects’ statistical datasets, and replace the last two numbers of the subject ID with two question marks (i.e., <code class="docutils literal notranslate"><span class="pre">??</span></code>). Then click on “apply pattern”. If all of the subjects were analyzed the same way and have the same directory structure, you should see 26 entries in the field below. Review them to make sure they are all there, and then click “OK”.</p>
<figure class="align-default">
<img alt="../../_images/07_Select_Datasets.gif" src="../../_images/07_Select_Datasets.gif" />
</figure>
<p>At the bottom of the “datasets A” section, you will see a few additional fields. In “set name (group of class), write <code class="docutils literal notranslate"><span class="pre">Inc-Con</span></code>, and in “data index/label” type <code class="docutils literal notranslate"><span class="pre">7</span></code>.</p>
<p>Why 7? If you open a Terminal and navigate to any of the subjects’ results directories (for example, sub-08), type</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">3</span><span class="n">dinfo</span> <span class="o">-</span><span class="n">verb</span> <span class="n">stats</span><span class="o">.</span><span class="n">sub</span><span class="o">-</span><span class="mi">08</span><span class="o">+</span><span class="n">tlrc</span>
</pre></div>
</div>
<p>This will show all of the sub-briks in that dataset, along with their labels. In our current example, we are looking for the contrast estimates for <code class="docutils literal notranslate"><span class="pre">incongruent-congruent</span></code>. The output of <code class="docutils literal notranslate"><span class="pre">3dinfo</span></code> shows that this is located in sub-brik 7. Any sub-brik that contains the label “Coef” means that it is a parameter (or contrast) estimate; the label “Tstat” indicates that it is a t-statistic. (Likewise, “Fstat” means that it is an F-statistic.)</p>
<figure class="align-default">
<img alt="../../_images/07_3dinfo_output.png" src="../../_images/07_3dinfo_output.png" />
</figure>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>What do you think the number to the right mean? For example, -19.2 to 11.3878? Why are they different between the “Coef” and the “Tstat” sub-briks? Does this difference make sense?</p>
</div>
<p>When you have finished, your GUI should look like the one below:</p>
<figure class="align-default">
<img alt="../../_images/07_3dttest_setup.png" src="../../_images/07_3dttest_setup.png" />
</figure>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you receive an error saying that one of the fields hasn’t been filled in - but you can clearly see that it has been filled in - click on another field, and then try clicking the “Go” icon again.</p>
</div>
</section>
<section id="generating-the-results">
<h2>Generating the Results<a class="headerlink" href="#generating-the-results" title="Link to this heading"></a></h2>
<p>As with the uber_subject.py script, there are buttons at the top of the GUI for both generating the script and then running the script. First click on the icon that looks like a sheet of paper with lines on it, which will show you the command that has been generated. Review it to see how it has inserted all of your inputs into a command called 3dttest++, which will run the actual group-level analysis. Then click on the green “Go” icon to run the test. (It should take only a second.)</p>
<p>When it has finished, go back to your Terminal and type <code class="docutils literal notranslate"><span class="pre">ls</span></code>. You will see a new directory called <code class="docutils literal notranslate"><span class="pre">group_results</span></code>, and within that a folder called <code class="docutils literal notranslate"><span class="pre">test.001.3dttest++</span></code>. Navigate into that folder, which contains the script that was used to generate the results (“Flanker_Inc-Con_ttest”), and another folder called <code class="docutils literal notranslate"><span class="pre">test.results</span></code>, which contains the group-level output “Flanker_Inc-Con_ttest+tlrc”. Load this in the afni viewer, and overlay it on top of the MNI152 template. Threshold the images to an uncorrected p-value of 0.001 (by right-clicking on the “p=” underneath the slider bar) and clusterize the data to only show clusters with an extent of 40 voxels or more; this will create an image like the one below. Does the location of the activation make sense, given the task and the paper this experiment was based on?</p>
<figure class="align-default">
<img alt="../../_images/07_GroupLevel_Results.gif" src="../../_images/07_GroupLevel_Results.gif" />
</figure>
<section id="modifying-the-3dttest-script">
<h3>Modifying the 3dttest++ Script<a class="headerlink" href="#modifying-the-3dttest-script" title="Link to this heading"></a></h3>
<p>You can also modify the Flanker_Inc-Con_ttest script that contains the 3dttest++ command, which looks like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>#!/bin/tcsh -xef

# created by uber_ttest.py: version 2.0 (December 28, 2017)
# creation date: Wed Feb 19 11:33:21 2020

# ---------------------- set process variables ----------------------

set mask_dset = /Users/ajahn/Desktop/Flanker/sub-01/sub-01.results/mask_group+tlrc

set dirA = /Users/ajahn/Desktop/Flanker

# specify and possibly create results directory
set results_dir = test.results
if ( ! -d $results_dir ) mkdir $results_dir

# ------------------------- process the data -------------------------

3dttest++ -prefix $results_dir/Flanker-Inc-Con                     \
          -mask $mask_dset                                         \
          -setA Inc-Con                                            \
             01 &quot;$dirA/sub-01/sub-01.results/stats.sub-01+tlrc[7]&quot; \
             02 &quot;$dirA/sub-02/sub-02.results/stats.sub-02+tlrc[7]&quot; \
             03 &quot;$dirA/sub-03/sub-03.results/stats.sub-03+tlrc[7]&quot; \
             04 &quot;$dirA/sub-04/sub-04.results/stats.sub-04+tlrc[7]&quot; \
             05 &quot;$dirA/sub-05/sub-05.results/stats.sub-05+tlrc[7]&quot; \
             06 &quot;$dirA/sub-06/sub-06.results/stats.sub-06+tlrc[7]&quot; \
             07 &quot;$dirA/sub-07/sub-07.results/stats.sub-07+tlrc[7]&quot; \
             08 &quot;$dirA/sub-08/sub-08.results/stats.sub-08+tlrc[7]&quot; \
             09 &quot;$dirA/sub-09/sub-09.results/stats.sub-09+tlrc[7]&quot; \
             10 &quot;$dirA/sub-10/sub-10.results/stats.sub-10+tlrc[7]&quot; \
             11 &quot;$dirA/sub-11/sub-11.results/stats.sub-11+tlrc[7]&quot; \
             12 &quot;$dirA/sub-12/sub-12.results/stats.sub-12+tlrc[7]&quot; \
             13 &quot;$dirA/sub-13/sub-13.results/stats.sub-13+tlrc[7]&quot; \
             14 &quot;$dirA/sub-14/sub-14.results/stats.sub-14+tlrc[7]&quot; \
             15 &quot;$dirA/sub-15/sub-15.results/stats.sub-15+tlrc[7]&quot; \
             16 &quot;$dirA/sub-16/sub-16.results/stats.sub-16+tlrc[7]&quot; \
             17 &quot;$dirA/sub-17/sub-17.results/stats.sub-17+tlrc[7]&quot; \
             18 &quot;$dirA/sub-18/sub-18.results/stats.sub-18+tlrc[7]&quot; \
             19 &quot;$dirA/sub-19/sub-19.results/stats.sub-19+tlrc[7]&quot; \
             20 &quot;$dirA/sub-20/sub-20.results/stats.sub-20+tlrc[7]&quot; \
             21 &quot;$dirA/sub-21/sub-21.results/stats.sub-21+tlrc[7]&quot; \
             22 &quot;$dirA/sub-22/sub-22.results/stats.sub-22+tlrc[7]&quot; \
             23 &quot;$dirA/sub-23/sub-23.results/stats.sub-23+tlrc[7]&quot; \
             24 &quot;$dirA/sub-24/sub-24.results/stats.sub-24+tlrc[7]&quot; \
             25 &quot;$dirA/sub-25/sub-25.results/stats.sub-25+tlrc[7]&quot; \
             26 &quot;$dirA/sub-26/sub-26.results/stats.sub-26+tlrc[7]&quot;
</pre></div>
</div>
<p>Using this code as a template, you would change the directory for the output and the mask to a location on your machine. You would then replace each of the input files with the ones that you are interested in comparing, while keeping an index number next to each (e.g., 1 through 26 in this example).</p>
<p>If you want to compare two different groups, you would use the <code class="docutils literal notranslate"><span class="pre">-setB</span></code> option:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>#!/bin/tcsh -xef

# created by uber_ttest.py: version 2.0 (December 28, 2017)
# creation date: Wed Feb 19 13:23:11 2020

# ---------------------- set process variables ----------------------

set mask_dset = /Users/ajahn/Desktop/Flanker/sub-01/sub-01.results/mask_group+tlrc

set dirA = /Users/ajahn/Desktop/Flanker

# specify and possibly create results directory
set results_dir = test.results
if ( ! -d $results_dir ) mkdir $results_dir

# ------------------------- process the data -------------------------

3dttest++ -prefix $results_dir/Flanker-Inc-Con -AminusB            \
          -mask $mask_dset                                         \
          -setA Inc-Con_Group1                                     \
             01 &quot;$dirA/sub-01/sub-01.results/stats.sub-01+tlrc[7]&quot; \
             02 &quot;$dirA/sub-02/sub-02.results/stats.sub-02+tlrc[7]&quot; \
             03 &quot;$dirA/sub-03/sub-03.results/stats.sub-03+tlrc[7]&quot; \
             04 &quot;$dirA/sub-04/sub-04.results/stats.sub-04+tlrc[7]&quot; \
             05 &quot;$dirA/sub-05/sub-05.results/stats.sub-05+tlrc[7]&quot; \
             06 &quot;$dirA/sub-06/sub-06.results/stats.sub-06+tlrc[7]&quot; \
             07 &quot;$dirA/sub-07/sub-07.results/stats.sub-07+tlrc[7]&quot; \
             08 &quot;$dirA/sub-08/sub-08.results/stats.sub-08+tlrc[7]&quot; \
             09 &quot;$dirA/sub-09/sub-09.results/stats.sub-09+tlrc[7]&quot; \
             10 &quot;$dirA/sub-10/sub-10.results/stats.sub-10+tlrc[7]&quot; \
             11 &quot;$dirA/sub-11/sub-11.results/stats.sub-11+tlrc[7]&quot; \
             12 &quot;$dirA/sub-12/sub-12.results/stats.sub-12+tlrc[7]&quot; \
             13 &quot;$dirA/sub-13/sub-13.results/stats.sub-13+tlrc[7]&quot; \
          -setB Inc-Con_Group2                                     \
             14 &quot;$dirA/sub-14/sub-14.results/stats.sub-14+tlrc[7]&quot; \
             15 &quot;$dirA/sub-15/sub-15.results/stats.sub-15+tlrc[7]&quot; \
             16 &quot;$dirA/sub-16/sub-16.results/stats.sub-16+tlrc[7]&quot; \
             17 &quot;$dirA/sub-17/sub-17.results/stats.sub-17+tlrc[7]&quot; \
             18 &quot;$dirA/sub-18/sub-18.results/stats.sub-18+tlrc[7]&quot; \
             19 &quot;$dirA/sub-19/sub-19.results/stats.sub-19+tlrc[7]&quot; \
             20 &quot;$dirA/sub-20/sub-20.results/stats.sub-20+tlrc[7]&quot; \
             21 &quot;$dirA/sub-21/sub-21.results/stats.sub-21+tlrc[7]&quot; \
             22 &quot;$dirA/sub-22/sub-22.results/stats.sub-22+tlrc[7]&quot; \
             23 &quot;$dirA/sub-23/sub-23.results/stats.sub-23+tlrc[7]&quot; \
             24 &quot;$dirA/sub-24/sub-24.results/stats.sub-24+tlrc[7]&quot; \
             25 &quot;$dirA/sub-25/sub-25.results/stats.sub-25+tlrc[7]&quot; \
             26 &quot;$dirA/sub-26/sub-26.results/stats.sub-26+tlrc[7]&quot;
</pre></div>
</div>
</section>
</section>
<section id="non-parametric-tests-with-3dclustsim">
<h2>Non-Parametric Tests with 3dClustSim<a class="headerlink" href="#non-parametric-tests-with-3dclustsim" title="Link to this heading"></a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For details on cluster thresholding and the terms that are used in this section, see <a class="reference internal" href="../../fMRI_Short_Course/fMRI_Appendices/Appendix_A_ClusterCorrection.html#appendix-a-clustercorrection"><span class="std std-ref">Appendix A</span></a> of the fMRI Course, focusing on the section “AFNI’s 3dFWHMx and 3dClustSim”.</p>
</div>
<p>Newer versions of AFNI (from about 2019 onwards) have a new option, <code class="docutils literal notranslate"><span class="pre">-3dClustSim</span></code>. This carries out a <strong>non-parametric</strong> test which doesn’t make any assumptions about the shape of the null distribution; instead, a null distribution is created from the data itself, and statistical significance is determined by comparing the data to its own null distribution.</p>
<p>This would be done by inserting the string <code class="docutils literal notranslate"><span class="pre">-3dClustSim</span></code> after the 3dttest++ command; e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>3dttest++ -ClustSim -prefix $results_dir/Flanker-Inc-Con                     \
        -mask $mask_dset                                         \
        -setA Inc-Con
</pre></div>
</div>
<p>And keeping the rest of the input files the same.</p>
<p>The output of this command will be a z-statistic image which you can threshold as you would any other statistical image. The command will also output .1D files that contain lists of how large a cluster has to be in order to be determined significant. For example, the file <code class="docutils literal notranslate"><span class="pre">TTnew.CSimA.NN3_bisided.1D</span></code> will contain rows of each cluster-forming threshold and columns for each corresponding alpha threshold. For example, you may see output like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># CLUSTER SIZE THRESHOLD(pthr,alpha) in Voxels</span>
<span class="c1"># -NN 3  | alpha = Prob(Cluster &gt;= given size)</span>
<span class="c1">#  pthr  | .10000 .09000 .08000 .07000 .06000 .05000 .04000 .03000 .02000 .01000</span>
<span class="c1"># ------ | ------ ------ ------ ------ ------ ------ ------ ------ ------ ------</span>
 <span class="mf">0.100000</span>    <span class="mi">7659</span>   <span class="mi">8174</span>   <span class="mi">8664</span>   <span class="mi">9262</span>   <span class="mi">9840</span>  <span class="mi">10571</span>  <span class="mi">11286</span>  <span class="mi">12271</span>  <span class="mi">13609</span>  <span class="mi">15859</span>
 <span class="mf">0.090000</span>    <span class="mi">6325</span>   <span class="mi">6804</span>   <span class="mi">7356</span>   <span class="mi">8015</span>   <span class="mi">8596</span>   <span class="mi">9246</span>  <span class="mi">10045</span>  <span class="mi">10982</span>  <span class="mi">12266</span>  <span class="mi">14584</span>
 <span class="mf">0.080000</span>    <span class="mi">4753</span>   <span class="mi">5301</span>   <span class="mi">5845</span>   <span class="mi">6425</span>   <span class="mi">7182</span>   <span class="mi">7830</span>   <span class="mi">8580</span>   <span class="mi">9649</span>  <span class="mi">10974</span>  <span class="mi">13194</span>
 <span class="mf">0.070000</span>    <span class="mi">3283</span>   <span class="mi">3696</span>   <span class="mi">4184</span>   <span class="mi">4778</span>   <span class="mi">5439</span>   <span class="mi">6243</span>   <span class="mi">7172</span>   <span class="mi">8153</span>   <span class="mi">9453</span>  <span class="mi">11699</span>
 <span class="mf">0.060000</span>    <span class="mi">2000</span>   <span class="mi">2291</span>   <span class="mi">2666</span>   <span class="mi">3136</span>   <span class="mi">3676</span>   <span class="mi">4409</span>   <span class="mi">5324</span>   <span class="mi">6295</span>   <span class="mi">7808</span>  <span class="mi">10056</span>
 <span class="mf">0.050000</span>    <span class="mi">1160</span>   <span class="mi">1336</span>   <span class="mi">1542</span>   <span class="mi">1797</span>   <span class="mi">2187</span>   <span class="mi">2629</span>   <span class="mi">3289</span>   <span class="mi">4323</span>   <span class="mi">5621</span>   <span class="mi">8082</span>
 <span class="mf">0.040000</span>     <span class="mi">659</span>    <span class="mi">740</span>    <span class="mi">843</span>   <span class="mi">1005</span>   <span class="mi">1194</span>   <span class="mi">1469</span>   <span class="mi">1801</span>   <span class="mi">2281</span>   <span class="mi">3385</span>   <span class="mi">5796</span>
 <span class="mf">0.030000</span>     <span class="mi">351</span>    <span class="mi">383</span>    <span class="mi">427</span>    <span class="mi">496</span>    <span class="mi">578</span>    <span class="mi">696</span>    <span class="mi">887</span>   <span class="mi">1148</span>   <span class="mi">1533</span>   <span class="mi">2837</span>
 <span class="mf">0.020000</span>     <span class="mi">170</span>    <span class="mi">188</span>    <span class="mi">207</span>    <span class="mi">230</span>    <span class="mi">262</span>    <span class="mi">305</span>    <span class="mi">373</span>    <span class="mi">476</span>    <span class="mi">664</span>   <span class="mi">1097</span>
 <span class="mf">0.015000</span>     <span class="mi">116</span>    <span class="mi">125</span>    <span class="mi">137</span>    <span class="mi">151</span>    <span class="mi">167</span>    <span class="mi">189</span>    <span class="mi">227</span>    <span class="mi">290</span>    <span class="mi">400</span>    <span class="mi">616</span>
 <span class="mf">0.010000</span>      <span class="mi">72</span>     <span class="mi">77</span>     <span class="mi">82</span>     <span class="mi">90</span>     <span class="mi">99</span>    <span class="mi">113</span>    <span class="mi">129</span>    <span class="mi">158</span>    <span class="mi">195</span>    <span class="mi">283</span>
 <span class="mf">0.007000</span>      <span class="mi">50</span>     <span class="mi">53</span>     <span class="mi">57</span>     <span class="mi">61</span>     <span class="mi">67</span>     <span class="mi">74</span>     <span class="mi">84</span>    <span class="mi">100</span>    <span class="mi">123</span>    <span class="mi">177</span>
 <span class="mf">0.005000</span>      <span class="mi">36</span>     <span class="mi">38</span>     <span class="mi">41</span>     <span class="mi">44</span>     <span class="mi">48</span>     <span class="mi">53</span>     <span class="mi">60</span>     <span class="mi">69</span>     <span class="mi">83</span>    <span class="mi">117</span>
 <span class="mf">0.003000</span>      <span class="mi">24</span>     <span class="mi">26</span>     <span class="mi">27</span>     <span class="mi">29</span>     <span class="mi">31</span>     <span class="mi">34</span>     <span class="mi">37</span>     <span class="mi">44</span>     <span class="mi">53</span>     <span class="mi">69</span>
 <span class="mf">0.002000</span>      <span class="mi">18</span>     <span class="mi">19</span>     <span class="mi">20</span>     <span class="mi">22</span>     <span class="mi">23</span>     <span class="mi">25</span>     <span class="mi">28</span>     <span class="mi">31</span>     <span class="mi">37</span>     <span class="mi">48</span>
 <span class="mf">0.001500</span>      <span class="mi">15</span>     <span class="mi">16</span>     <span class="mi">17</span>     <span class="mi">18</span>     <span class="mi">19</span>     <span class="mi">20</span>     <span class="mi">22</span>     <span class="mi">25</span>     <span class="mi">30</span>     <span class="mi">39</span>
 <span class="mf">0.001000</span>      <span class="mi">12</span>     <span class="mi">13</span>     <span class="mi">13</span>     <span class="mi">14</span>     <span class="mi">15</span>     <span class="mi">16</span>     <span class="mi">17</span>     <span class="mi">19</span>     <span class="mi">22</span>     <span class="mi">29</span>
</pre></div>
</div>
<p>Going down the list to the row next to a cluster-forming threshold of p=0.001, we see that we would need a cluster size of 16 or greater in order to determine that the cluster is significant at the p=0.05 threshold.</p>
</section>
<section id="using-3dmema">
<h2>Using 3dMEMA<a class="headerlink" href="#using-3dmema" title="Link to this heading"></a></h2>
<p>Close the AFNI viewer, and then use the Terminal to navigate back to the directory containing your subjects. Go back to the uber_ttest.py GUI (or open a new one), and make the following changes:</p>
<ol class="arabic simple">
<li><p>Change the “program” from 3dttest++ to 3dMEMA.</p></li>
<li><p>Change the “script name” and “dset prefix” to <code class="docutils literal notranslate"><span class="pre">Flanker_Inc-Con_MEMA</span></code>.</p></li>
<li><p>Click on “get subj dsets”, and select a subject’s statistical dataset that has the “REML” string (e.g., <code class="docutils literal notranslate"><span class="pre">stats.sub-08_REML+tlrc</span></code>). Use the wildcards as above to select all of the subjects’ REML datasets.</p></li>
<li><p>In the field “t-stat index/label (MEMA)”, type <code class="docutils literal notranslate"><span class="pre">8</span></code>. The sub-briks of the REML dataset, which should be in an order identical to the non-REML statistical dataset, indicate that sub-brik #8 is the t-statistic associated with the contrast estimate of “incongruent-congruent.”</p></li>
</ol>
<p>As before, click on the script generator icon, and then click on the green “Go” button. This model estimation will take longer, and you will see a progress report for each slice that has been analyzed; in total, it should take only a couple of minutes.</p>
<figure class="align-default">
<img alt="../../_images/07_3dMEMA_setup.png" src="../../_images/07_3dMEMA_setup.png" />
</figure>
<p>When it has finished, you will see a new directory in the group_results folder called <code class="docutils literal notranslate"><span class="pre">test.002.3dMEMA</span></code>, with a sub-directory called <code class="docutils literal notranslate"><span class="pre">test.results</span></code>. Navigate to that folder, and overlay the results as before. Are the effects in the same location? Do these effects look stronger or weaker? Why?</p>
</section>
<section id="video">
<h2>Video<a class="headerlink" href="#video" title="Link to this heading"></a></h2>
<p>Click <a class="reference external" href="https://www.youtube.com/watch?v=JdgjeUTG-fc">here</a> for a walkthrough of how to do group-level analysis in AFNI.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="AFNI_06_Scripting.html" class="btn btn-neutral float-left" title="AFNI Tutorial #6: Scripting" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="AFNI_08_ROIAnalysis.html" class="btn btn-neutral float-right" title="AFNI Tutorial #8: ROI Analysis" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Andy Jahn.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>