<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Appendix A: Parametric Modulation in AFNI &mdash; Andy&#39;s Brain Book 1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b76e3c8a" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=f2a433a1"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Appendix B: Analyzing Rat Data" href="AppendixB_AnimalAnalysis.html" />
    <link rel="prev" title="SUMA Tutorial #5: Region of Interest Analysis" href="SUMA/SUMA_05_ROIAnalysisOnTheSurface.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Andy's Brain Book
          </a>
              <div class="version">
                1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Install</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../installation/fsl_mac_install.html">Overview</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Unix for Neuroimagers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_Intro.html">What is Unix?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_01_Navigation.html">Unix Tutorial #1: 目录操作 (Directories and Navigation)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_02_CopyRemove.html">Unix Tutorial #2: Copying and Removing Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_03_ReadingTextFiles.html">Unix Tutorial #3: Reading Text Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_04_ShellsVariables.html">Unix Tutorial #4: Shells and Path Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_05_ForLoops.html">Unix Tutorial #5: For-Loops</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_06_IfElse.html">Unix Tutorial #6: Conditional Statements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_07_Scripting.html">Unix Tutorial #7: Scripting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_08_Sed.html">Unix Tutorial #8: The Sed Command</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../unix/Unix_09_AutomatingTheAnalysis.html">Unix Tutorial #9: Automating The Analysis</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">fMRI Short Course with FSL</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_Intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_01_DataDownload.html">fMRI Tutorial #1: Downloading the Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_02_ExperimentalDesign.html">fMRI Tutorial #2: Overview of The Flanker Task</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_03_LookingAtTheData.html">fMRI Tutorial #3: Looking at the Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_04_Preprocessing.html">fMRI Tutorial #4: Preprocessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_05_1stLevelAnalysis.html">fMRI Tutorial #5: Statistics and Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_06_Scripting.html">fMRI Tutorial #6: Scripting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_07_2ndLevelAnalysis.html">fMRI Tutorial #7: 2nd-Level Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_08_3rdLevelAnalysis.html">fMRI Tutorial #8: 3rd-Level Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_09_ROIAnalysis.html">fMRI Tutorial #9: ROI Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_10_Summary.html">fMRI Tutorial #10: Summary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fMRI_Short_Course/fMRI_Appendices.html">fMRI Short Course: Appendices</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">FreeSurfer</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../FreeSurfer/FreeSurfer_Introduction.html">FreeSurfer Short Course</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">E-Prime</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../E-Prime/E-Prime_Overview.html">Overview of E-Prime</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">AFNI</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../AFNI_Overview.html">AFNI Overview</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../AFNI_Overview.html#what-is-afni">What is AFNI?</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="AFNI_fMRI_Intro.html">Introduction to AFNI</a></li>
<li class="toctree-l3"><a class="reference internal" href="AFNI_01_DataDownload.html">AFNI Tutorial #1: Downloading the Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="AFNI_02_ExperimentalDesign.html">AFNI Tutorial #2: The Flanker Experiment</a></li>
<li class="toctree-l3"><a class="reference internal" href="AFNI_03_LookingAtTheData.html">AFNI Tutorial #3: Looking at the Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="AFNI_04_Preprocessing.html">AFNI Tutorial #4: AFNI Commands and Preprocessing</a></li>
<li class="toctree-l3"><a class="reference internal" href="AFNI_05_1stLevelAnalysis.html">AFNI Tutorial #5: Statistics and Modeling</a></li>
<li class="toctree-l3"><a class="reference internal" href="AFNI_06_Scripting.html">AFNI Tutorial #6: Scripting</a></li>
<li class="toctree-l3"><a class="reference internal" href="AFNI_07_GroupAnalysis.html">AFNI Tutorial #7: Group Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="AFNI_08_ROIAnalysis.html">AFNI Tutorial #8: ROI Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="AFNI_09_SurfaceAnalysis.html">AFNI Tutorial #9: Surface-Based Analysis with SUMA</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Appendix A: Parametric Modulation in AFNI</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#preprocessing-the-data">Preprocessing the Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="#running-the-analysis">Running the Analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="#group-level-analysis">Group-Level Analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="#video">Video</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="AppendixB_AnimalAnalysis.html">Appendix B: Analyzing Rat Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="AppendixC_HighlightingResults.html">Appendix C: Highlighting Vs. Hiding Results</a></li>
<li class="toctree-l3"><a class="reference internal" href="AppendixD_EffectSizes.html">Appendix D: Reporting Effect Sizes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">SPM</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../SPM/SPM_Overview.html">SPM Overview</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Functional Connectivity with the CONN Toolbox</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../FunctionalConnectivity/CONN_Overview.html">Functional Connectivity and the CONN Toolbox</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Parametric Modulation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../PM/PM_Overview.html">Parametric Modulation in SPM, FSL, and AFNI</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Image Visualization with MRIcroGL</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../MRIcroGL/MRIcroGL_Overview.html">Image Visualization with MRIcroGL</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Introduction to the Human Connectome Project (HCP)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../HCP/HCP_Overview.html">Introduction to the Human Connectome Project</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Finite Impulse Response (FIR) Models</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../FIR/FIR_Overview.html">Finite Impulse Response (FIR)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">fMRI Concepts</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Practicals/DesignOptimization.html">Design Optimization</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Diffusion Analysis with MRtrix</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../MRtrix/MRtrix_Introduction.html">Introduction to MRtrix</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ASL Analysis</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../ASL/ASL_Techniques.html">fASL Tutorial #1: Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ASL/fASL_02_Download.html">fASL Tutorial #2: Downloading and Installing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ASL/fASL_03_Task.html">fASL Tutorial #3: The N-Back Task</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ASL/04_fASL_GUI.html">fASL Tutorial #4: The GUI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ASL/05_fASL_Results.html">fASL Tutorial #5: Examining the Results</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ASL/06_fASL_Quantification.html">fASL Tutorial #6: Quantification</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Frequently Asked Questions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../FrequentlyAskedQuestions/FrequentlyAskedQuestions.html">Frequently Asked Questions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Statistics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Statistics/GIMME.html">GIMME (Group Iterative Multiple Model Estimation)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Open Science</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../OpenScience/OS_Overview.html">Open Science</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced Normalization Tools (ANTs)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../ANTs/ANTs_Overview.html">Advanced Normalization Tools (ANTs)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tract-Based Spatial Statistics (TBSS)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../TBSS/TBSS_Overview.html">Introduction to Tract-Based Spatial Statistics (TBSS)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Statistics for Neuroimagers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Stats/Stats_Overview.html">Statistics for Neuroimagers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Machine Learning for Neuroimagers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../ML/ML_Overview.html">Machine Learning for Neuroimagers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Slicer</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Slicer/Slicer_Overview.html">Slicer Overview</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">CAT12</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../CAT12/CAT12_Overview.html">Voxel-Based Morphometry with CAT12</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Using the Supercomputer</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Supercomputer/Supercomputer_Overview.html">Introduction to Supercomputing</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Matlab for Neuroimagers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Matlab/Matlab_Overview.html">Matlab for Neuroimagers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ITK-Snap</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../ITK-Snap/ITK-Snap_Overview.html">ITK-Snap_Overview</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Python for Neuroimagers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../PythonForNeuroimagers/PythonForNeuroimagers_Overview.html">Python for Neuroimagers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Meta-Analysis for fMRI</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../MetaAnalysis/MetaAnalysis_Overview.html">Meta-Analysis for Neuroimagers</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Andy's Brain Book</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../AFNI_Overview.html">AFNI Overview</a></li>
      <li class="breadcrumb-item active">Appendix A: Parametric Modulation in AFNI</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/AFNI/AFNI_Short_Course/AppendixA_ParametricModulation.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="appendix-a-parametric-modulation-in-afni">
<span id="appendixa-parametricmodulation"></span><h1>Appendix A: Parametric Modulation in AFNI<a class="headerlink" href="#appendix-a-parametric-modulation-in-afni" title="Link to this heading"></a></h1>
<hr class="docutils" />
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading"></a></h2>
<p>This tutorial will show you how to set up a parametric modulation analysis in AFNI. A review of parametric modulation, as well as the dataset we will be analyzing, can be found <a class="reference internal" href="../../PM/PM_Overview.html#pm-overview"><span class="std std-ref">here</span></a>. This tutorial will focus on preprocessing the data and using the parametric modulators in the general linear model.</p>
</section>
<section id="preprocessing-the-data">
<h2>Preprocessing the Data<a class="headerlink" href="#preprocessing-the-data" title="Link to this heading"></a></h2>
<hr class="docutils" />
<section id="creating-the-timing-files">
<h3>Creating the Timing Files<a class="headerlink" href="#creating-the-timing-files" title="Link to this heading"></a></h3>
<p>We will first create timing files that contain onsets for the Gamble, the parametric value for the potential Gain, and the parametric value for the potential Loss, for each run; in total, we will create nine regressors.</p>
<p>You can download a script to convert the timings into a format that AFNI understands by clicking <a class="reference external" href="https://github.com/andrewjahn/AFNI_Scripts/blob/master/make_Gamble_Timings.sh">here</a>, clicking on the <code class="docutils literal notranslate"><span class="pre">Raw</span></code> button, and right-clicking anywhere on the screen and selecting <code class="docutils literal notranslate"><span class="pre">Save</span> <span class="pre">As</span></code>. Save the file as a shell script into the <code class="docutils literal notranslate"><span class="pre">Gambles</span></code> directory. Once it has been downloaded, navigate to that directory with a Terminal and run the script by typing <code class="docutils literal notranslate"><span class="pre">bash</span> <span class="pre">make_Gamble_Timings.sh</span></code>. Within each func directory you should now see a file called <code class="docutils literal notranslate"><span class="pre">gamble_Timings.1D</span></code>, which looks like the following:</p>
<figure class="align-default">
<img alt="../../_images/AppendixA_OnsetTimes.png" src="../../_images/AppendixA_OnsetTimes.png" />
</figure>
<p>The first number is the onset of the gamble; the asterisk indicates that the numbers coming after it are the modulators, separated by a comma. We will use this in the model for each subject.</p>
</section>
<section id="creating-the-preprocessing-script">
<h3>Creating the Preprocessing Script<a class="headerlink" href="#creating-the-preprocessing-script" title="Link to this heading"></a></h3>
<p>Similar to the <a class="reference internal" href="AFNI_06_Scripting.html#afni-06-scripting"><span class="std std-ref">scripting section</span></a> of the AFNI tutorial, we will create a Batch script that can be used in a for-loop to analyze all of our subjects. Instead of using the <code class="docutils literal notranslate"><span class="pre">uber_subject.py</span></code> GUI, however, we will use the command <code class="docutils literal notranslate"><span class="pre">afni_proc.py</span></code>. The script can be downloaded <a class="reference external" href="https://github.com/andrewjahn/AFNI_Scripts/blob/master/runAFNIproc.sh">here</a>; click on <code class="docutils literal notranslate"><span class="pre">Raw</span></code>, right-click and choose <code class="docutils literal notranslate"><span class="pre">Save</span> <span class="pre">As</span></code>, and download it to your <code class="docutils literal notranslate"><span class="pre">Gambles</span></code> directory. If we open the file, this is what is inside:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>#!/bin/tcsh
set subj = $argv[1]

 afni_proc.py -subj_id ${subj} -script proc.${subj} -scr_overwrite -blocks tshift                                                  \
   align tlrc volreg blur mask scale regress -copy_anat                                                                  \
   $PWD/{$subj}/anat/{$subj}_T1w.nii.gz                     \
   -dsets                                                                                                                \
   $PWD/{$subj}/func/{$subj}_task-mixedgamblestask_run-01_bold.nii.gz \
   $PWD/{$subj}/func/{$subj}_task-mixedgamblestask_run-02_bold.nii.gz \
   $PWD/{$subj}/func/{$subj}_task-mixedgamblestask_run-03_bold.nii.gz \
   -tcat_remove_first_trs 0 -align_opts_aea -giant_move -tlrc_base                                                       \
   MNI_avg152T1+tlrc -volreg_align_to MIN_OUTLIER -volreg_align_e2a                                                      \
   -volreg_tlrc_warp -blur_size 4.0 -regress_stim_times                                                                  \
   $PWD/{$subj}/func/gamble_Timings.1D                          \
   -regress_stim_labels Gamble -regress_stim_types AM2 -regress_basis &#39;BLOCK(3,1)&#39;     \
   -regress_censor_motion 0.3 -regress_motion_per_run -regress_opts_3dD                                                  \
   -jobs 8 -regress_make_ideal_sum sum_ideal.1D                                                  \
   -regress_run_clustsim no

tcsh proc.${subj}
</pre></div>
</div>
<p>The first line uses the first argument, or input, as the subject number for the rest of the script. The blocks tshift, align, tlrc, and so on, indicate the standard preprocessing steps of slice-timing correction, realignment, normalization, etc. The major difference from analyzing a non-parametric modulation dataset is using <code class="docutils literal notranslate"><span class="pre">AM2</span></code>, which stands for Amplitude Modulation. This will orthogonalize the modulators with respect to the main regressor, but not with respect to each other; for more details on why this is important, see the link to the Mumford et al. paper down below.</p>
</section>
</section>
<section id="running-the-analysis">
<h2>Running the Analysis<a class="headerlink" href="#running-the-analysis" title="Link to this heading"></a></h2>
<p>Now that we have a template preprocessing script, we can use it in a for-loop to analyze all of the subjects. Type the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>for i in `cat subjList.txt`; do
  tcsh runAFNIProc.sh $i;
done
</pre></div>
</div>
<p>This will take a couple of hours. We will return when it has finished preprocessing.</p>
</section>
<section id="group-level-analysis">
<h2>Group-Level Analysis<a class="headerlink" href="#group-level-analysis" title="Link to this heading"></a></h2>
<p>If you navigate into one of the output directories, such as <code class="docutils literal notranslate"><span class="pre">sub-01.results</span></code>, and open AFNI, load the warped anatomical image as an underlay and the <code class="docutils literal notranslate"><span class="pre">stats.sub-01.+tlrc</span></code> image as an overlay:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">afni</span> <span class="n">anat_final</span><span class="o">.</span><span class="n">sub</span><span class="o">-</span><span class="mi">01</span><span class="o">+</span><span class="n">tlrc</span><span class="o">.</span> <span class="n">stats</span><span class="o">.</span><span class="n">sub</span><span class="o">-</span><span class="mi">01</span><span class="o">+</span><span class="n">tlrc</span><span class="o">.</span>
</pre></div>
</div>
<p>In the <code class="docutils literal notranslate"><span class="pre">Define</span> <span class="pre">Overlay</span></code> window, there are multiple options in the <code class="docutils literal notranslate"><span class="pre">OLay</span></code> and <code class="docutils literal notranslate"><span class="pre">Thr</span></code> dropdown menus. The first one (<code class="docutils literal notranslate"><span class="pre">Gamble#0_Coef</span></code>) is the beta weight for the main regressor of “Gamble”, while sub-brik 3 of <code class="docutils literal notranslate"><span class="pre">Gamble#1_Coef</span></code> corresponds to the parametric modulator of Gain and sub-brik 5 of <code class="docutils literal notranslate"><span class="pre">Gamble#2_Coef</span></code> corresponds to the parametric modulator of Loss. We will use these last two regressors as inputs into our group-level analysis.</p>
<figure class="align-default">
<img alt="../../_images/AppendixA_GambleOverlays.png" src="../../_images/AppendixA_GambleOverlays.png" />
</figure>
<p>Our script will look like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>#!/bin/tcsh -xef

# created by uber_ttest.py: version 2.0 (December 28, 2017)
# creation date: Wed Feb 19 11:33:21 2020

# ---------------------- set process variables ----------------------

set mask_dset = $PWD/sub-01.results/mask_group+tlrc

set dirA = $PWD

# specify and possibly create results directory
set results_dir = test.results
if ( ! -d $results_dir ) mkdir $results_dir

# ------------------------- process the data -------------------------

3dttest++ -prefix $results_dir/GainPM                     \
        -mask $mask_dset                                         \
        -setA GainPM                                           \
           01 &quot;$dirA/sub-01.results/stats.sub-01+tlrc[3]&quot; \
           02 &quot;$dirA/sub-02.results/stats.sub-02+tlrc[3]&quot; \
           03 &quot;$dirA/sub-03.results/stats.sub-03+tlrc[3]&quot; \
           04 &quot;$dirA/sub-04.results/stats.sub-04+tlrc[3]&quot; \
           05 &quot;$dirA/sub-05.results/stats.sub-05+tlrc[3]&quot; \
           06 &quot;$dirA/sub-06.results/stats.sub-06+tlrc[3]&quot; \
           07 &quot;$dirA/sub-07.results/stats.sub-07+tlrc[3]&quot; \
           08 &quot;$dirA/sub-08.results/stats.sub-08+tlrc[3]&quot; \
           09 &quot;$dirA/sub-09.results/stats.sub-09+tlrc[3]&quot; \
           10 &quot;$dirA/sub-10.results/stats.sub-10+tlrc[3]&quot; \
           11 &quot;$dirA/sub-11.results/stats.sub-11+tlrc[3]&quot; \
           12 &quot;$dirA/sub-12.results/stats.sub-12+tlrc[3]&quot; \
           13 &quot;$dirA/sub-13.results/stats.sub-13+tlrc[3]&quot; \
           14 &quot;$dirA/sub-14.results/stats.sub-14+tlrc[3]&quot; \
           15 &quot;$dirA/sub-15.results/stats.sub-15+tlrc[3]&quot; \
           16 &quot;$dirA/sub-16.results/stats.sub-16+tlrc[3]&quot;
</pre></div>
</div>
<p>Copy and paste this into your terminal, or download it <a class="reference external" href="https://github.com/andrewjahn/AFNI_Scripts/blob/master/runGroupAnalysis_GainPM.sh">here</a>. It will create a new directory called GainPM, which you can overlay on a template brain and threshold at whatever level you want. At a relatively liberal voxel-wise uncorrected threshold of p=0.01, you can see that the gain modulators load significantly on the caudate nucleus. If we do the same analysis for the Loss modulators, which is sub-brik 5, you will see negative loadings in the same region. Compare this to the Tom et al. paper; do the results look similar? We could strengthen our results by changing the preprocessing or the GLM - for example, by increasing the smoothing kernel, or by using REML model estimation. This is left as an exercise for you to do on your own.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Because we have only 16 subjects, we won’t be able to use AFNI’s ETAC option, which is simliar to FSL’s threshold-free cluster enhancement. If you did have more subjects, however, you could try using this option as well.</p>
</div>
</section>
<section id="video">
<h2>Video<a class="headerlink" href="#video" title="Link to this heading"></a></h2>
<p>For a demonstration of what parametric analysis in AFNI looks like, click <a class="reference external" href="https://youtu.be/vF87n4kZxwU">here</a>.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="SUMA/SUMA_05_ROIAnalysisOnTheSurface.html" class="btn btn-neutral float-left" title="SUMA Tutorial #5: Region of Interest Analysis" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="AppendixB_AnimalAnalysis.html" class="btn btn-neutral float-right" title="Appendix B: Analyzing Rat Data" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Andy Jahn.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>